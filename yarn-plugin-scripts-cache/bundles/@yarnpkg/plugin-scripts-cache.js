/* eslint-disable */
//prettier-ignore
module.exports = {
name: "@yarnpkg/plugin-scripts-cache",
factory: function (require) {
"use strict";var plugin=(()=>{var ar=Object.create;var ae=Object.defineProperty;var sr=Object.getOwnPropertyDescriptor;var or=Object.getOwnPropertyNames;var cr=Object.getPrototypeOf,ur=Object.prototype.hasOwnProperty;var b=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var P=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),lr=(e,t)=>{for(var r in t)ae(e,r,{get:t[r],enumerable:!0})},Xe=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of or(t))!ur.call(e,i)&&i!==r&&ae(e,i,{get:()=>t[i],enumerable:!(n=sr(t,i))||n.enumerable});return e};var se=(e,t,r)=>(r=e!=null?ar(cr(e)):{},Xe(t||!e||!e.__esModule?ae(r,"default",{value:e,enumerable:!0}):r,e)),hr=e=>Xe(ae({},"__esModule",{value:!0}),e);var ct=P(be=>{var q=b("path"),L=process.platform==="win32",j=b("fs"),br=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function wr(){var e;if(br){var t=new Error;e=r}else e=n;return e;function r(i){i&&(t.message=i.message,i=t,n(i))}function n(i){if(i){if(process.throwDeprecation)throw i;if(!process.noDeprecation){var s="fs: missing callback "+(i.stack||i.message);process.traceDeprecation?console.trace(s):console.error(s)}}}}function Cr(e){return typeof e=="function"?e:wr()}var $n=q.normalize;L?F=/(.*?)(?:[\/\\]+|$)/g:F=/(.*?)(?:[\/]+|$)/g;var F;L?Y=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/:Y=/^[\/]*/;var Y;be.realpathSync=function(t,r){if(t=q.resolve(t),r&&Object.prototype.hasOwnProperty.call(r,t))return r[t];var n=t,i={},s={},a,o,c,u;h();function h(){var g=Y.exec(t);a=g[0].length,o=g[0],c=g[0],u="",L&&!s[c]&&(j.lstatSync(c),s[c]=!0)}for(;a<t.length;){F.lastIndex=a;var d=F.exec(t);if(u=o,o+=d[0],c=u+d[1],a=F.lastIndex,!(s[c]||r&&r[c]===c)){var l;if(r&&Object.prototype.hasOwnProperty.call(r,c))l=r[c];else{var f=j.lstatSync(c);if(!f.isSymbolicLink()){s[c]=!0,r&&(r[c]=c);continue}var p=null;if(!L){var y=f.dev.toString(32)+":"+f.ino.toString(32);i.hasOwnProperty(y)&&(p=i[y])}p===null&&(j.statSync(c),p=j.readlinkSync(c)),l=q.resolve(u,p),r&&(r[c]=l),L||(i[y]=p)}t=q.resolve(l,t.slice(a)),h()}}return r&&(r[n]=t),t};be.realpath=function(t,r,n){if(typeof n!="function"&&(n=Cr(r),r=null),t=q.resolve(t),r&&Object.prototype.hasOwnProperty.call(r,t))return process.nextTick(n.bind(null,null,r[t]));var i=t,s={},a={},o,c,u,h;d();function d(){var g=Y.exec(t);o=g[0].length,c=g[0],u=g[0],h="",L&&!a[u]?j.lstat(u,function(A){if(A)return n(A);a[u]=!0,l()}):process.nextTick(l)}function l(){if(o>=t.length)return r&&(r[i]=t),n(null,t);F.lastIndex=o;var g=F.exec(t);return h=c,c+=g[0],u=h+g[1],o=F.lastIndex,a[u]||r&&r[u]===u?process.nextTick(l):r&&Object.prototype.hasOwnProperty.call(r,u)?y(r[u]):j.lstat(u,f)}function f(g,A){if(g)return n(g);if(!A.isSymbolicLink())return a[u]=!0,r&&(r[u]=u),process.nextTick(l);if(!L){var I=A.dev.toString(32)+":"+A.ino.toString(32);if(s.hasOwnProperty(I))return p(null,s[I],u)}j.stat(u,function(D){if(D)return n(D);j.readlink(u,function(E,m){L||(s[I]=m),p(E,m)})})}function p(g,A,I){if(g)return n(g);var D=q.resolve(h,A);r&&(r[I]=D),y(D)}function y(g){t=q.resolve(g,t.slice(o)),d()}}});var _e=P((Gn,ft)=>{ft.exports=R;R.realpath=R;R.sync=Ae;R.realpathSync=Ae;R.monkeypatch=_r;R.unmonkeypatch=Sr;var J=b("fs"),we=J.realpath,Ce=J.realpathSync,Ar=process.version,ut=/^v[0-5]\./.test(Ar),lt=ct();function ht(e){return e&&e.syscall==="realpath"&&(e.code==="ELOOP"||e.code==="ENOMEM"||e.code==="ENAMETOOLONG")}function R(e,t,r){if(ut)return we(e,t,r);typeof t=="function"&&(r=t,t=null),we(e,t,function(n,i){ht(n)?lt.realpath(e,t,r):r(n,i)})}function Ae(e,t){if(ut)return Ce(e,t);try{return Ce(e,t)}catch(r){if(ht(r))return lt.realpathSync(e,t);throw r}}function _r(){J.realpath=R,J.realpathSync=Ae}function Sr(){J.realpath=we,J.realpathSync=Ce}});var dt=P((Vn,pt)=>{var kr=typeof process=="object"&&process&&process.platform==="win32";pt.exports=kr?{sep:"\\"}:{sep:"/"}});var Et=P((Wn,yt)=>{"use strict";yt.exports=gt;function gt(e,t,r){e instanceof RegExp&&(e=mt(e,r)),t instanceof RegExp&&(t=mt(t,r));var n=vt(e,t,r);return n&&{start:n[0],end:n[1],pre:r.slice(0,n[0]),body:r.slice(n[0]+e.length,n[1]),post:r.slice(n[1]+t.length)}}function mt(e,t){var r=t.match(e);return r?r[0]:null}gt.range=vt;function vt(e,t,r){var n,i,s,a,o,c=r.indexOf(e),u=r.indexOf(t,c+1),h=c;if(c>=0&&u>0){if(e===t)return[c,u];for(n=[],s=r.length;h>=0&&!o;)h==c?(n.push(h),c=r.indexOf(e,h+1)):n.length==1?o=[n.pop(),u]:(i=n.pop(),i<s&&(s=i,a=u),u=r.indexOf(t,h+1)),h=c<u&&c>=0?c:u;n.length&&(o=[s,a])}return o}});var Nt=P((qn,kt)=>{var bt=Et();kt.exports=Or;var wt="\0SLASH"+Math.random()+"\0",Ct="\0OPEN"+Math.random()+"\0",ke="\0CLOSE"+Math.random()+"\0",At="\0COMMA"+Math.random()+"\0",_t="\0PERIOD"+Math.random()+"\0";function Se(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function Nr(e){return e.split("\\\\").join(wt).split("\\{").join(Ct).split("\\}").join(ke).split("\\,").join(At).split("\\.").join(_t)}function Pr(e){return e.split(wt).join("\\").split(Ct).join("{").split(ke).join("}").split(At).join(",").split(_t).join(".")}function St(e){if(!e)return[""];var t=[],r=bt("{","}",e);if(!r)return e.split(",");var n=r.pre,i=r.body,s=r.post,a=n.split(",");a[a.length-1]+="{"+i+"}";var o=St(s);return s.length&&(a[a.length-1]+=o.shift(),a.push.apply(a,o)),t.push.apply(t,a),t}function Or(e){return e?(e.substr(0,2)==="{}"&&(e="\\{\\}"+e.substr(2)),ee(Nr(e),!0).map(Pr)):[]}function xr(e){return"{"+e+"}"}function Ur(e){return/^-?0\d/.test(e)}function Ir(e,t){return e<=t}function Dr(e,t){return e>=t}function ee(e,t){var r=[],n=bt("{","}",e);if(!n)return[e];var i=n.pre,s=n.post.length?ee(n.post,!1):[""];if(/\$$/.test(n.pre))for(var a=0;a<s.length;a++){var o=i+"{"+n.body+"}"+s[a];r.push(o)}else{var c=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(n.body),u=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(n.body),h=c||u,d=n.body.indexOf(",")>=0;if(!h&&!d)return n.post.match(/,.*\}/)?(e=n.pre+"{"+n.body+ke+n.post,ee(e)):[e];var l;if(h)l=n.body.split(/\.\./);else if(l=St(n.body),l.length===1&&(l=ee(l[0],!1).map(xr),l.length===1))return s.map(function(me){return n.pre+l[0]+me});var f;if(h){var p=Se(l[0]),y=Se(l[1]),g=Math.max(l[0].length,l[1].length),A=l.length==3?Math.abs(Se(l[2])):1,I=Ir,D=y<p;D&&(A*=-1,I=Dr);var E=l.some(Ur);f=[];for(var m=p;I(m,y);m+=A){var N;if(u)N=String.fromCharCode(m),N==="\\"&&(N="");else if(N=String(m),E){var G=g-N.length;if(G>0){var x=new Array(G+1).join("0");m<0?N="-"+x+N.slice(1):N=x+N}}f.push(N)}}else{f=[];for(var M=0;M<l.length;M++)f.push.apply(f,ee(l[M],!1))}for(var M=0;M<f.length;M++)for(var a=0;a<s.length;a++){var o=i+f[M]+s[a];(!t||h||o)&&r.push(o)}}return r}});var fe=P((Bn,xe)=>{var O=xe.exports=(e,t,r={})=>(he(t),!r.nocomment&&t.charAt(0)==="#"?!1:new X(t,r).match(e));xe.exports=O;var Pe=dt();O.sep=Pe.sep;var U=Symbol("globstar **");O.GLOBSTAR=U;var Mr=Nt(),Pt={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},Oe="[^/]",Ne=Oe+"*?",Fr="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",jr="(?:(?!(?:\\/|^)\\.).)*?",Ut=e=>e.split("").reduce((t,r)=>(t[r]=!0,t),{}),Ot=Ut("().*{}+?[]^$\\!"),Lr=Ut("[.("),xt=/\/+/;O.filter=(e,t={})=>(r,n,i)=>O(r,e,t);var $=(e,t={})=>{let r={};return Object.keys(e).forEach(n=>r[n]=e[n]),Object.keys(t).forEach(n=>r[n]=t[n]),r};O.defaults=e=>{if(!e||typeof e!="object"||!Object.keys(e).length)return O;let t=O,r=(n,i,s)=>t(n,i,$(e,s));return r.Minimatch=class extends t.Minimatch{constructor(i,s){super(i,$(e,s))}},r.Minimatch.defaults=n=>t.defaults($(e,n)).Minimatch,r.filter=(n,i)=>t.filter(n,$(e,i)),r.defaults=n=>t.defaults($(e,n)),r.makeRe=(n,i)=>t.makeRe(n,$(e,i)),r.braceExpand=(n,i)=>t.braceExpand(n,$(e,i)),r.match=(n,i,s)=>t.match(n,i,$(e,s)),r};O.braceExpand=(e,t)=>It(e,t);var It=(e,t={})=>(he(e),t.nobrace||!/\{(?:(?!\{).)*\}/.test(e)?[e]:Mr(e)),Rr=1024*64,he=e=>{if(typeof e!="string")throw new TypeError("invalid pattern");if(e.length>Rr)throw new TypeError("pattern is too long")},le=Symbol("subparse");O.makeRe=(e,t)=>new X(e,t||{}).makeRe();O.match=(e,t,r={})=>{let n=new X(t,r);return e=e.filter(i=>n.match(i)),n.options.nonull&&!e.length&&e.push(t),e};var $r=e=>e.replace(/\\(.)/g,"$1"),Tr=e=>e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),X=class{constructor(t,r){he(t),r||(r={}),this.options=r,this.set=[],this.pattern=t,this.windowsPathsNoEscape=!!r.windowsPathsNoEscape||r.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!r.partial,this.make()}debug(){}make(){let t=this.pattern,r=this.options;if(!r.nocomment&&t.charAt(0)==="#"){this.comment=!0;return}if(!t){this.empty=!0;return}this.parseNegate();let n=this.globSet=this.braceExpand();r.debug&&(this.debug=(...i)=>console.error(...i)),this.debug(this.pattern,n),n=this.globParts=n.map(i=>i.split(xt)),this.debug(this.pattern,n),n=n.map((i,s,a)=>i.map(this.parse,this)),this.debug(this.pattern,n),n=n.filter(i=>i.indexOf(!1)===-1),this.debug(this.pattern,n),this.set=n}parseNegate(){if(this.options.nonegate)return;let t=this.pattern,r=!1,n=0;for(let i=0;i<t.length&&t.charAt(i)==="!";i++)r=!r,n++;n&&(this.pattern=t.substr(n)),this.negate=r}matchOne(t,r,n){var i=this.options;this.debug("matchOne",{this:this,file:t,pattern:r}),this.debug("matchOne",t.length,r.length);for(var s=0,a=0,o=t.length,c=r.length;s<o&&a<c;s++,a++){this.debug("matchOne loop");var u=r[a],h=t[s];if(this.debug(r,u,h),u===!1)return!1;if(u===U){this.debug("GLOBSTAR",[r,u,h]);var d=s,l=a+1;if(l===c){for(this.debug("** at the end");s<o;s++)if(t[s]==="."||t[s]===".."||!i.dot&&t[s].charAt(0)===".")return!1;return!0}for(;d<o;){var f=t[d];if(this.debug(`
globstar while`,t,d,r,l,f),this.matchOne(t.slice(d),r.slice(l),n))return this.debug("globstar found match!",d,o,f),!0;if(f==="."||f===".."||!i.dot&&f.charAt(0)==="."){this.debug("dot detected!",t,d,r,l);break}this.debug("globstar swallow a segment, and continue"),d++}return!!(n&&(this.debug(`
>>> no match, partial?`,t,d,r,l),d===o))}var p;if(typeof u=="string"?(p=h===u,this.debug("string match",u,h,p)):(p=h.match(u),this.debug("pattern match",u,h,p)),!p)return!1}if(s===o&&a===c)return!0;if(s===o)return n;if(a===c)return s===o-1&&t[s]==="";throw new Error("wtf?")}braceExpand(){return It(this.pattern,this.options)}parse(t,r){he(t);let n=this.options;if(t==="**")if(n.noglobstar)t="*";else return U;if(t==="")return"";let i="",s=!!n.nocase,a=!1,o=[],c=[],u,h=!1,d=-1,l=-1,f,p,y,g=t.charAt(0)==="."?"":n.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",A=()=>{if(u){switch(u){case"*":i+=Ne,s=!0;break;case"?":i+=Oe,s=!0;break;default:i+="\\"+u;break}this.debug("clearStateChar %j %j",u,i),u=!1}};for(let E=0,m;E<t.length&&(m=t.charAt(E));E++){if(this.debug("%s	%s %s %j",t,E,i,m),a){if(m==="/")return!1;Ot[m]&&(i+="\\"),i+=m,a=!1;continue}switch(m){case"/":return!1;case"\\":A(),a=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",t,E,i,m),h){this.debug("  in class"),m==="!"&&E===l+1&&(m="^"),i+=m;continue}this.debug("call clearStateChar %j",u),A(),u=m,n.noext&&A();continue;case"(":if(h){i+="(";continue}if(!u){i+="\\(";continue}o.push({type:u,start:E-1,reStart:i.length,open:Pt[u].open,close:Pt[u].close}),i+=u==="!"?"(?:(?!(?:":"(?:",this.debug("plType %j %j",u,i),u=!1;continue;case")":if(h||!o.length){i+="\\)";continue}A(),s=!0,p=o.pop(),i+=p.close,p.type==="!"&&c.push(p),p.reEnd=i.length;continue;case"|":if(h||!o.length){i+="\\|";continue}A(),i+="|";continue;case"[":if(A(),h){i+="\\"+m;continue}h=!0,l=E,d=i.length,i+=m;continue;case"]":if(E===l+1||!h){i+="\\"+m;continue}f=t.substring(l+1,E);try{RegExp("["+f+"]")}catch{y=this.parse(f,le),i=i.substr(0,d)+"\\["+y[0]+"\\]",s=s||y[1],h=!1;continue}s=!0,h=!1,i+=m;continue;default:A(),Ot[m]&&!(m==="^"&&h)&&(i+="\\"),i+=m;break}}for(h&&(f=t.substr(l+1),y=this.parse(f,le),i=i.substr(0,d)+"\\["+y[0],s=s||y[1]),p=o.pop();p;p=o.pop()){let E;E=i.slice(p.reStart+p.open.length),this.debug("setting tail",i,p),E=E.replace(/((?:\\{2}){0,64})(\\?)\|/g,(N,G,x)=>(x||(x="\\"),G+G+x+"|")),this.debug(`tail=%j
   %s`,E,E,p,i);let m=p.type==="*"?Ne:p.type==="?"?Oe:"\\"+p.type;s=!0,i=i.slice(0,p.reStart)+m+"\\("+E}A(),a&&(i+="\\\\");let I=Lr[i.charAt(0)];for(let E=c.length-1;E>-1;E--){let m=c[E],N=i.slice(0,m.reStart),G=i.slice(m.reStart,m.reEnd-8),x=i.slice(m.reEnd),M=i.slice(m.reEnd-8,m.reEnd)+x,me=N.split("(").length-1,ge=x;for(let Je=0;Je<me;Je++)ge=ge.replace(/\)[+*?]?/,"");x=ge;let ir=x===""&&r!==le?"$":"";i=N+G+x+ir+M}if(i!==""&&s&&(i="(?=.)"+i),I&&(i=g+i),r===le)return[i,s];if(!s)return $r(t);let D=n.nocase?"i":"";try{return Object.assign(new RegExp("^"+i+"$",D),{_glob:t,_src:i})}catch{return new RegExp("$.")}}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;let t=this.set;if(!t.length)return this.regexp=!1,this.regexp;let r=this.options,n=r.noglobstar?Ne:r.dot?Fr:jr,i=r.nocase?"i":"",s=t.map(a=>(a=a.map(o=>typeof o=="string"?Tr(o):o===U?U:o._src).reduce((o,c)=>(o[o.length-1]===U&&c===U||o.push(c),o),[]),a.forEach((o,c)=>{o!==U||a[c-1]===U||(c===0?a.length>1?a[c+1]="(?:\\/|"+n+"\\/)?"+a[c+1]:a[c]=n:c===a.length-1?a[c-1]+="(?:\\/|"+n+")?":(a[c-1]+="(?:\\/|\\/"+n+"\\/)"+a[c+1],a[c+1]=U))}),a.filter(o=>o!==U).join("/"))).join("|");s="^(?:"+s+")$",this.negate&&(s="^(?!"+s+").*$");try{this.regexp=new RegExp(s,i)}catch{this.regexp=!1}return this.regexp}match(t,r=this.partial){if(this.debug("match",t,this.pattern),this.comment)return!1;if(this.empty)return t==="";if(t==="/"&&r)return!0;let n=this.options;Pe.sep!=="/"&&(t=t.split(Pe.sep).join("/")),t=t.split(xt),this.debug(this.pattern,"split",t);let i=this.set;this.debug(this.pattern,"set",i);let s;for(let a=t.length-1;a>=0&&(s=t[a],!s);a--);for(let a=0;a<i.length;a++){let o=i[a],c=t;if(n.matchBase&&o.length===1&&(c=[s]),this.matchOne(c,o,r))return n.flipNegate?!0:!this.negate}return n.flipNegate?!1:this.negate}static defaults(t){return O.defaults(t).Minimatch}};O.Minimatch=X});var Dt=P((Kn,Ue)=>{typeof Object.create=="function"?Ue.exports=function(t,r){r&&(t.super_=r,t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:Ue.exports=function(t,r){if(r){t.super_=r;var n=function(){};n.prototype=r.prototype,t.prototype=new n,t.prototype.constructor=t}}});var Mt=P((Qn,De)=>{try{if(Ie=b("util"),typeof Ie.inherits!="function")throw"";De.exports=Ie.inherits}catch{De.exports=Dt()}var Ie});var Fe=P(T=>{T.setopts=Br;T.ownProp=Ft;T.makeAbs=te;T.finish=Kr;T.mark=Qr;T.isIgnored=Lt;T.childrenIgnored=Jr;function Ft(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var Gr=b("fs"),H=b("path"),Vr=fe(),jt=b("path").isAbsolute,Me=Vr.Minimatch;function Wr(e,t){return e.localeCompare(t,"en")}function qr(e,t){e.ignore=t.ignore||[],Array.isArray(e.ignore)||(e.ignore=[e.ignore]),e.ignore.length&&(e.ignore=e.ignore.map(Hr))}function Hr(e){var t=null;if(e.slice(-3)==="/**"){var r=e.replace(/(\/\*\*)+$/,"");t=new Me(r,{dot:!0})}return{matcher:new Me(e,{dot:!0}),gmatcher:t}}function Br(e,t,r){if(r||(r={}),r.matchBase&&t.indexOf("/")===-1){if(r.noglobstar)throw new Error("base matching requires globstar");t="**/"+t}e.silent=!!r.silent,e.pattern=t,e.strict=r.strict!==!1,e.realpath=!!r.realpath,e.realpathCache=r.realpathCache||Object.create(null),e.follow=!!r.follow,e.dot=!!r.dot,e.mark=!!r.mark,e.nodir=!!r.nodir,e.nodir&&(e.mark=!0),e.sync=!!r.sync,e.nounique=!!r.nounique,e.nonull=!!r.nonull,e.nosort=!!r.nosort,e.nocase=!!r.nocase,e.stat=!!r.stat,e.noprocess=!!r.noprocess,e.absolute=!!r.absolute,e.fs=r.fs||Gr,e.maxLength=r.maxLength||1/0,e.cache=r.cache||Object.create(null),e.statCache=r.statCache||Object.create(null),e.symlinks=r.symlinks||Object.create(null),qr(e,r),e.changedCwd=!1;var n=process.cwd();Ft(r,"cwd")?(e.cwd=H.resolve(r.cwd),e.changedCwd=e.cwd!==n):e.cwd=H.resolve(n),e.root=r.root||H.resolve(e.cwd,"/"),e.root=H.resolve(e.root),e.cwdAbs=jt(e.cwd)?e.cwd:te(e,e.cwd),e.nomount=!!r.nomount,process.platform==="win32"&&(e.root=e.root.replace(/\\/g,"/"),e.cwd=e.cwd.replace(/\\/g,"/"),e.cwdAbs=e.cwdAbs.replace(/\\/g,"/")),r.nonegate=!0,r.nocomment=!0,r.allowWindowsEscape=!0,e.minimatch=new Me(t,r),e.options=e.minimatch.options}function Kr(e){for(var t=e.nounique,r=t?[]:Object.create(null),n=0,i=e.matches.length;n<i;n++){var s=e.matches[n];if(!s||Object.keys(s).length===0){if(e.nonull){var a=e.minimatch.globSet[n];t?r.push(a):r[a]=!0}}else{var o=Object.keys(s);t?r.push.apply(r,o):o.forEach(function(c){r[c]=!0})}}if(t||(r=Object.keys(r)),e.nosort||(r=r.sort(Wr)),e.mark){for(var n=0;n<r.length;n++)r[n]=e._mark(r[n]);e.nodir&&(r=r.filter(function(c){var u=!/\/$/.test(c),h=e.cache[c]||e.cache[te(e,c)];return u&&h&&(u=h!=="DIR"&&!Array.isArray(h)),u}))}e.ignore.length&&(r=r.filter(function(c){return!Lt(e,c)})),e.found=r}function Qr(e,t){var r=te(e,t),n=e.cache[r],i=t;if(n){var s=n==="DIR"||Array.isArray(n),a=t.slice(-1)==="/";if(s&&!a?i+="/":!s&&a&&(i=i.slice(0,-1)),i!==t){var o=te(e,i);e.statCache[o]=e.statCache[r],e.cache[o]=e.cache[r]}}return i}function te(e,t){var r=t;return t.charAt(0)==="/"?r=H.join(e.root,t):jt(t)||t===""?r=t:e.changedCwd?r=H.resolve(e.cwd,t):r=H.resolve(t),process.platform==="win32"&&(r=r.replace(/\\/g,"/")),r}function Lt(e,t){return e.ignore.length?e.ignore.some(function(r){return r.matcher.match(t)||!!(r.gmatcher&&r.gmatcher.match(t))}):!1}function Jr(e,t){return e.ignore.length?e.ignore.some(function(r){return!!(r.gmatcher&&r.gmatcher.match(t))}):!1}});var Vt=P((Yn,Gt)=>{Gt.exports=Tt;Tt.GlobSync=_;var Xr=_e(),Rt=fe(),Xn=Rt.Minimatch,zn=Re().Glob,Zn=b("util"),je=b("path"),$t=b("assert"),pe=b("path").isAbsolute,B=Fe(),zr=B.setopts,Le=B.ownProp,Zr=B.childrenIgnored,Yr=B.isIgnored;function Tt(e,t){if(typeof t=="function"||arguments.length===3)throw new TypeError(`callback provided to sync glob
See: https://github.com/isaacs/node-glob/issues/167`);return new _(e,t).found}function _(e,t){if(!e)throw new Error("must provide pattern");if(typeof t=="function"||arguments.length===3)throw new TypeError(`callback provided to sync glob
See: https://github.com/isaacs/node-glob/issues/167`);if(!(this instanceof _))return new _(e,t);if(zr(this,e,t),this.noprocess)return this;var r=this.minimatch.set.length;this.matches=new Array(r);for(var n=0;n<r;n++)this._process(this.minimatch.set[n],n,!1);this._finish()}_.prototype._finish=function(){if($t.ok(this instanceof _),this.realpath){var e=this;this.matches.forEach(function(t,r){var n=e.matches[r]=Object.create(null);for(var i in t)try{i=e._makeAbs(i);var s=Xr.realpathSync(i,e.realpathCache);n[s]=!0}catch(a){if(a.syscall==="stat")n[e._makeAbs(i)]=!0;else throw a}})}B.finish(this)};_.prototype._process=function(e,t,r){$t.ok(this instanceof _);for(var n=0;typeof e[n]=="string";)n++;var i;switch(n){case e.length:this._processSimple(e.join("/"),t);return;case 0:i=null;break;default:i=e.slice(0,n).join("/");break}var s=e.slice(n),a;i===null?a=".":((pe(i)||pe(e.map(function(u){return typeof u=="string"?u:"[*]"}).join("/")))&&(!i||!pe(i))&&(i="/"+i),a=i);var o=this._makeAbs(a);if(!Zr(this,a)){var c=s[0]===Rt.GLOBSTAR;c?this._processGlobStar(i,a,o,s,t,r):this._processReaddir(i,a,o,s,t,r)}};_.prototype._processReaddir=function(e,t,r,n,i,s){var a=this._readdir(r,s);if(!!a){for(var o=n[0],c=!!this.minimatch.negate,u=o._glob,h=this.dot||u.charAt(0)===".",d=[],l=0;l<a.length;l++){var f=a[l];if(f.charAt(0)!=="."||h){var p;c&&!e?p=!f.match(o):p=f.match(o),p&&d.push(f)}}var y=d.length;if(y!==0){if(n.length===1&&!this.mark&&!this.stat){this.matches[i]||(this.matches[i]=Object.create(null));for(var l=0;l<y;l++){var f=d[l];e&&(e.slice(-1)!=="/"?f=e+"/"+f:f=e+f),f.charAt(0)==="/"&&!this.nomount&&(f=je.join(this.root,f)),this._emitMatch(i,f)}return}n.shift();for(var l=0;l<y;l++){var f=d[l],g;e?g=[e,f]:g=[f],this._process(g.concat(n),i,s)}}}};_.prototype._emitMatch=function(e,t){if(!Yr(this,t)){var r=this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=r),!this.matches[e][t]){if(this.nodir){var n=this.cache[r];if(n==="DIR"||Array.isArray(n))return}this.matches[e][t]=!0,this.stat&&this._stat(t)}}};_.prototype._readdirInGlobStar=function(e){if(this.follow)return this._readdir(e,!1);var t,r,n;try{r=this.fs.lstatSync(e)}catch(s){if(s.code==="ENOENT")return null}var i=r&&r.isSymbolicLink();return this.symlinks[e]=i,!i&&r&&!r.isDirectory()?this.cache[e]="FILE":t=this._readdir(e,!1),t};_.prototype._readdir=function(e,t){var r;if(t&&!Le(this.symlinks,e))return this._readdirInGlobStar(e);if(Le(this.cache,e)){var n=this.cache[e];if(!n||n==="FILE")return null;if(Array.isArray(n))return n}try{return this._readdirEntries(e,this.fs.readdirSync(e))}catch(i){return this._readdirError(e,i),null}};_.prototype._readdirEntries=function(e,t){if(!this.mark&&!this.stat)for(var r=0;r<t.length;r++){var n=t[r];e==="/"?n=e+n:n=e+"/"+n,this.cache[n]=!0}return this.cache[e]=t,t};_.prototype._readdirError=function(e,t){switch(t.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(e);if(this.cache[r]="FILE",r===this.cwdAbs){var n=new Error(t.code+" invalid cwd "+this.cwd);throw n.path=this.cwd,n.code=t.code,n}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:if(this.cache[this._makeAbs(e)]=!1,this.strict)throw t;this.silent||console.error("glob error",t);break}};_.prototype._processGlobStar=function(e,t,r,n,i,s){var a=this._readdir(r,s);if(!!a){var o=n.slice(1),c=e?[e]:[],u=c.concat(o);this._process(u,i,!1);var h=a.length,d=this.symlinks[r];if(!(d&&s))for(var l=0;l<h;l++){var f=a[l];if(!(f.charAt(0)==="."&&!this.dot)){var p=c.concat(a[l],o);this._process(p,i,!0);var y=c.concat(a[l],n);this._process(y,i,!0)}}}};_.prototype._processSimple=function(e,t){var r=this._stat(e);if(this.matches[t]||(this.matches[t]=Object.create(null)),!!r){if(e&&pe(e)&&!this.nomount){var n=/[\/\\]$/.test(e);e.charAt(0)==="/"?e=je.join(this.root,e):(e=je.resolve(this.root,e),n&&(e+="/"))}process.platform==="win32"&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e)}};_.prototype._stat=function(e){var t=this._makeAbs(e),r=e.slice(-1)==="/";if(e.length>this.maxLength)return!1;if(!this.stat&&Le(this.cache,t)){var a=this.cache[t];if(Array.isArray(a)&&(a="DIR"),!r||a==="DIR")return a;if(r&&a==="FILE")return!1}var n,i=this.statCache[t];if(!i){var s;try{s=this.fs.lstatSync(t)}catch(o){if(o&&(o.code==="ENOENT"||o.code==="ENOTDIR"))return this.statCache[t]=!1,!1}if(s&&s.isSymbolicLink())try{i=this.fs.statSync(t)}catch{i=s}else i=s}this.statCache[t]=i;var a=!0;return i&&(a=i.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||a,r&&a==="FILE"?!1:a};_.prototype._mark=function(e){return B.mark(this,e)};_.prototype._makeAbs=function(e){return B.makeAbs(this,e)}});var $e=P((ei,qt)=>{qt.exports=Wt;function Wt(e,t){if(e&&t)return Wt(e)(t);if(typeof e!="function")throw new TypeError("need wrapper function");return Object.keys(e).forEach(function(n){r[n]=e[n]}),r;function r(){for(var n=new Array(arguments.length),i=0;i<n.length;i++)n[i]=arguments[i];var s=e.apply(this,n),a=n[n.length-1];return typeof s=="function"&&s!==a&&Object.keys(a).forEach(function(o){s[o]=a[o]}),s}}});var Ge=P((ti,Te)=>{var Ht=$e();Te.exports=Ht(de);Te.exports.strict=Ht(Bt);de.proto=de(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return de(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return Bt(this)},configurable:!0})});function de(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function Bt(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},r=e.name||"Function wrapped with `once`";return t.onceError=r+" shouldn't be called more than once",t.called=!1,t}});var Qt=P((ri,Kt)=>{var en=$e(),re=Object.create(null),tn=Ge();Kt.exports=en(rn);function rn(e,t){return re[e]?(re[e].push(t),null):(re[e]=[t],nn(e))}function nn(e){return tn(function t(){var r=re[e],n=r.length,i=an(arguments);try{for(var s=0;s<n;s++)r[s].apply(null,i)}finally{r.length>n?(r.splice(0,n),process.nextTick(function(){t.apply(null,i)})):delete re[e]}})}function an(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n]=e[n];return r}});var Re=P((ai,Xt)=>{Xt.exports=K;var sn=_e(),Jt=fe(),ni=Jt.Minimatch,on=Mt(),cn=b("events").EventEmitter,Ve=b("path"),We=b("assert"),ne=b("path").isAbsolute,He=Vt(),Q=Fe(),un=Q.setopts,qe=Q.ownProp,Be=Qt(),ii=b("util"),ln=Q.childrenIgnored,hn=Q.isIgnored,fn=Ge();function K(e,t,r){if(typeof t=="function"&&(r=t,t={}),t||(t={}),t.sync){if(r)throw new TypeError("callback provided to sync glob");return He(e,t)}return new v(e,t,r)}K.sync=He;var pn=K.GlobSync=He.GlobSync;K.glob=K;function dn(e,t){if(t===null||typeof t!="object")return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}K.hasMagic=function(e,t){var r=dn({},t);r.noprocess=!0;var n=new v(e,r),i=n.minimatch.set;if(!e)return!1;if(i.length>1)return!0;for(var s=0;s<i[0].length;s++)if(typeof i[0][s]!="string")return!0;return!1};K.Glob=v;on(v,cn);function v(e,t,r){if(typeof t=="function"&&(r=t,t=null),t&&t.sync){if(r)throw new TypeError("callback provided to sync glob");return new pn(e,t)}if(!(this instanceof v))return new v(e,t,r);un(this,e,t),this._didRealPath=!1;var n=this.minimatch.set.length;this.matches=new Array(n),typeof r=="function"&&(r=fn(r),this.on("error",r),this.on("end",function(c){r(null,c)}));var i=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(n===0)return o();for(var s=!0,a=0;a<n;a++)this._process(this.minimatch.set[a],a,!1,o);s=!1;function o(){--i._processing,i._processing<=0&&(s?process.nextTick(function(){i._finish()}):i._finish())}}v.prototype._finish=function(){if(We(this instanceof v),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();Q.finish(this),this.emit("end",this.found)}};v.prototype._realpath=function(){if(this._didRealpath)return;this._didRealpath=!0;var e=this.matches.length;if(e===0)return this._finish();for(var t=this,r=0;r<this.matches.length;r++)this._realpathSet(r,n);function n(){--e===0&&t._finish()}};v.prototype._realpathSet=function(e,t){var r=this.matches[e];if(!r)return t();var n=Object.keys(r),i=this,s=n.length;if(s===0)return t();var a=this.matches[e]=Object.create(null);n.forEach(function(o,c){o=i._makeAbs(o),sn.realpath(o,i.realpathCache,function(u,h){u?u.syscall==="stat"?a[o]=!0:i.emit("error",u):a[h]=!0,--s===0&&(i.matches[e]=a,t())})})};v.prototype._mark=function(e){return Q.mark(this,e)};v.prototype._makeAbs=function(e){return Q.makeAbs(this,e)};v.prototype.abort=function(){this.aborted=!0,this.emit("abort")};v.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))};v.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var e=this._emitQueue.slice(0);this._emitQueue.length=0;for(var t=0;t<e.length;t++){var r=e[t];this._emitMatch(r[0],r[1])}}if(this._processQueue.length){var n=this._processQueue.slice(0);this._processQueue.length=0;for(var t=0;t<n.length;t++){var i=n[t];this._processing--,this._process(i[0],i[1],i[2],i[3])}}}};v.prototype._process=function(e,t,r,n){if(We(this instanceof v),We(typeof n=="function"),!this.aborted){if(this._processing++,this.paused){this._processQueue.push([e,t,r,n]);return}for(var i=0;typeof e[i]=="string";)i++;var s;switch(i){case e.length:this._processSimple(e.join("/"),t,n);return;case 0:s=null;break;default:s=e.slice(0,i).join("/");break}var a=e.slice(i),o;s===null?o=".":((ne(s)||ne(e.map(function(h){return typeof h=="string"?h:"[*]"}).join("/")))&&(!s||!ne(s))&&(s="/"+s),o=s);var c=this._makeAbs(o);if(ln(this,o))return n();var u=a[0]===Jt.GLOBSTAR;u?this._processGlobStar(s,o,c,a,t,r,n):this._processReaddir(s,o,c,a,t,r,n)}};v.prototype._processReaddir=function(e,t,r,n,i,s,a){var o=this;this._readdir(r,s,function(c,u){return o._processReaddir2(e,t,r,n,i,s,u,a)})};v.prototype._processReaddir2=function(e,t,r,n,i,s,a,o){if(!a)return o();for(var c=n[0],u=!!this.minimatch.negate,h=c._glob,d=this.dot||h.charAt(0)===".",l=[],f=0;f<a.length;f++){var p=a[f];if(p.charAt(0)!=="."||d){var y;u&&!e?y=!p.match(c):y=p.match(c),y&&l.push(p)}}var g=l.length;if(g===0)return o();if(n.length===1&&!this.mark&&!this.stat){this.matches[i]||(this.matches[i]=Object.create(null));for(var f=0;f<g;f++){var p=l[f];e&&(e!=="/"?p=e+"/"+p:p=e+p),p.charAt(0)==="/"&&!this.nomount&&(p=Ve.join(this.root,p)),this._emitMatch(i,p)}return o()}n.shift();for(var f=0;f<g;f++){var p=l[f],A;e&&(e!=="/"?p=e+"/"+p:p=e+p),this._process([p].concat(n),i,s,o)}o()};v.prototype._emitMatch=function(e,t){if(!this.aborted&&!hn(this,t)){if(this.paused){this._emitQueue.push([e,t]);return}var r=ne(t)?t:this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=r),!this.matches[e][t]){if(this.nodir){var n=this.cache[r];if(n==="DIR"||Array.isArray(n))return}this.matches[e][t]=!0;var i=this.statCache[r];i&&this.emit("stat",t,i),this.emit("match",t)}}};v.prototype._readdirInGlobStar=function(e,t){if(this.aborted)return;if(this.follow)return this._readdir(e,!1,t);var r="lstat\0"+e,n=this,i=Be(r,s);i&&n.fs.lstat(e,i);function s(a,o){if(a&&a.code==="ENOENT")return t();var c=o&&o.isSymbolicLink();n.symlinks[e]=c,!c&&o&&!o.isDirectory()?(n.cache[e]="FILE",t()):n._readdir(e,!1,t)}};v.prototype._readdir=function(e,t,r){if(!this.aborted&&(r=Be("readdir\0"+e+"\0"+t,r),!!r)){if(t&&!qe(this.symlinks,e))return this._readdirInGlobStar(e,r);if(qe(this.cache,e)){var n=this.cache[e];if(!n||n==="FILE")return r();if(Array.isArray(n))return r(null,n)}var i=this;i.fs.readdir(e,mn(this,e,r))}};function mn(e,t,r){return function(n,i){n?e._readdirError(t,n,r):e._readdirEntries(t,i,r)}}v.prototype._readdirEntries=function(e,t,r){if(!this.aborted){if(!this.mark&&!this.stat)for(var n=0;n<t.length;n++){var i=t[n];e==="/"?i=e+i:i=e+"/"+i,this.cache[i]=!0}return this.cache[e]=t,r(null,t)}};v.prototype._readdirError=function(e,t,r){if(!this.aborted){switch(t.code){case"ENOTSUP":case"ENOTDIR":var n=this._makeAbs(e);if(this.cache[n]="FILE",n===this.cwdAbs){var i=new Error(t.code+" invalid cwd "+this.cwd);i.path=this.cwd,i.code=t.code,this.emit("error",i),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:this.cache[this._makeAbs(e)]=!1,this.strict&&(this.emit("error",t),this.abort()),this.silent||console.error("glob error",t);break}return r()}};v.prototype._processGlobStar=function(e,t,r,n,i,s,a){var o=this;this._readdir(r,s,function(c,u){o._processGlobStar2(e,t,r,n,i,s,u,a)})};v.prototype._processGlobStar2=function(e,t,r,n,i,s,a,o){if(!a)return o();var c=n.slice(1),u=e?[e]:[],h=u.concat(c);this._process(h,i,!1,o);var d=this.symlinks[r],l=a.length;if(d&&s)return o();for(var f=0;f<l;f++){var p=a[f];if(!(p.charAt(0)==="."&&!this.dot)){var y=u.concat(a[f],c);this._process(y,i,!0,o);var g=u.concat(a[f],n);this._process(g,i,!0,o)}}o()};v.prototype._processSimple=function(e,t,r){var n=this;this._stat(e,function(i,s){n._processSimple2(e,t,i,s,r)})};v.prototype._processSimple2=function(e,t,r,n,i){if(this.matches[t]||(this.matches[t]=Object.create(null)),!n)return i();if(e&&ne(e)&&!this.nomount){var s=/[\/\\]$/.test(e);e.charAt(0)==="/"?e=Ve.join(this.root,e):(e=Ve.resolve(this.root,e),s&&(e+="/"))}process.platform==="win32"&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e),i()};v.prototype._stat=function(e,t){var r=this._makeAbs(e),n=e.slice(-1)==="/";if(e.length>this.maxLength)return t();if(!this.stat&&qe(this.cache,r)){var i=this.cache[r];if(Array.isArray(i)&&(i="DIR"),!n||i==="DIR")return t(null,i);if(n&&i==="FILE")return t()}var s,a=this.statCache[r];if(a!==void 0){if(a===!1)return t(null,a);var o=a.isDirectory()?"DIR":"FILE";return n&&o==="FILE"?t():t(null,o,a)}var c=this,u=Be("stat\0"+r,h);u&&c.fs.lstat(r,u);function h(d,l){if(l&&l.isSymbolicLink())return c.fs.stat(r,function(f,p){f?c._stat2(e,r,null,l,t):c._stat2(e,r,f,p,t)});c._stat2(e,r,d,l,t)}};v.prototype._stat2=function(e,t,r,n,i){if(r&&(r.code==="ENOENT"||r.code==="ENOTDIR"))return this.statCache[t]=!1,i();var s=e.slice(-1)==="/";if(this.statCache[t]=n,t.slice(-1)==="/"&&n&&!n.isDirectory())return i(null,!1,n);var a=!0;return n&&(a=n.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||a,s&&a==="FILE"?i():i(null,a,n)}});var Sn={};lr(Sn,{default:()=>_n});var z=b("@yarnpkg/core");var C=b("@yarnpkg/core"),V=b("@yarnpkg/fslib"),w=".yarn-scripts-cache-rc.json";function fr(e,t){if(typeof e!="object")return t.reportError(C.MessageName.UNNAMED,`${w} is not valid: config is not an object!`),!1;if(!Array.isArray(e.scriptsToCache))return t.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.scriptsToCache is not an array!`),!1;if(e.scriptsToCache.find(r=>typeof r!="object")!==void 0)return t.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.scriptsToCache should only contain objects!`),!1;if(e.scriptsToCache.find(r=>!dr(r,t))!==void 0)return!1;if(e.remoteCache){if(typeof e.remoteCache!="string")return t.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.remoteCache should be a string!`),!1;if(!pr(e.remoteCache))return t.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.remoteCache should be a valid URLs!`),!1}return e.cacheUsage&&!ve(e.cacheUsage)?(t.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.cacheUsage is not a valid value!`),!1):e.localCacheUsage&&!ve(e.localCacheUsage)?(t.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.localCacheUsage is not a valid value!`),!1):e.remoteCacheUsage&&!ve(e.remoteCacheUsage)?(t.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.remoteCacheUsage is not a valid value!`),!1):e.localCacheMaxAge!==void 0&&typeof e.localCacheMaxAge!="number"?(t.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.localCacheMaxAge should be a number!`),!1):e.localCacheMaxAmount!==void 0&&typeof e.localCacheMaxAmount!="number"?(t.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.localCacheMaxAmount should be a number!`),!1):!0}function ve(e){return e==="enabled"||e==="disabled"||e==="update-cache-only"||e==="update-script-execution-result-only"}function pr(e){try{return new URL(e),!0}catch{return!1}}function dr(e,t){if(typeof e.scriptName!="string")return t.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.scriptsToCache.scriptName is no string!`),!1;if(e.inputIncludes!==void 0&&typeof e.inputIncludes!="string"){if(!Array.isArray(e.inputIncludes))return t.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.scriptsToCache.inputIncludes for ${e.scriptName} is not an array!`),!1;if(e.inputIncludes.find(r=>typeof r!="string")!==void 0)return t.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.scriptsToCache.inputIncludes for ${e.scriptName} should only contain strings!`),!1}if(e.inputExcludes!==void 0&&typeof e.inputExcludes!="string"){if(!Array.isArray(e.inputExcludes))return t.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.scriptsToCache.inputExcludes for ${e.scriptName} is not an array!`),!1;if(e.inputExcludes.find(r=>typeof r!="string")!==void 0)return t.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.scriptsToCache.inputExcludes for ${e.scriptName} should only contain strings!`),!1}if(e.outputIncludes!==void 0&&typeof e.outputIncludes!="string"){if(!Array.isArray(e.outputIncludes))return t.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.scriptsToCache.outputIncludes for ${e.scriptName} is not an array!`),!1;if(e.outputIncludes.find(r=>typeof r!="string")!==void 0)return t.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.scriptsToCache.outputIncludes for ${e.scriptName} should only contain strings!`),!1}if(e.outputExcludes!==void 0&&typeof e.outputExcludes!="string"){if(!Array.isArray(e.outputExcludes))return t.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.scriptsToCache.outputExcludes for ${e.scriptName} is not an array!`),!1;if(e.outputExcludes.find(r=>typeof r!="string")!==void 0)return t.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.scriptsToCache.outputExcludes for ${e.scriptName} should only contain strings!`),!1}if(e.environmentVariableIncludes!==void 0&&typeof e.environmentVariableIncludes!="string"){if(!Array.isArray(e.environmentVariableIncludes))return t.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.scriptsToCache.environmentVariableIncludes for ${e.scriptName} is not an array!`),!1;if(e.environmentVariableIncludes.find(r=>typeof r!="string")!==void 0)return t.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.scriptsToCache.environmentVariableIncludes for ${e.scriptName} should only contain strings!`),!1}return!0}async function oe(e,t){let r=V.ppath.join(e,(0,V.toFilename)(w));if(await V.xfs.existsPromise(r)){let n=await V.xfs.readFilePromise(r,"utf-8");try{let i=JSON.parse(n);if(fr(i,t))return i}catch(i){t.reportErrorOnce(C.MessageName.EXCEPTION,`${w} is not valid:`),t.reportExceptionOnce(i)}}}var S=b("@yarnpkg/fslib");var Z="SCRIPT_RESULTS_CACHE",ze=Z+"_LOCAL",Ze=Z+"_REMOTE",W="disabled",ye="update-cache-only",Ee="update-script-execution-result-only";function Ye(e){return(process.env[Z]||e.cacheUsage)===W}function et(e){let t=process.env[Z]||e.cacheUsage;return t!==W&&t!==Ee}function tt(e){let t=process.env[Z]||e.cacheUsage;return t!==W&&t!==ye}function rt(e){let t=process.env[ze]||e.localCacheUsage;return t!==W&&t!==Ee}function nt(e){let t=process.env[ze]||e.localCacheUsage;return t!==W&&t!==ye}function it(e){let t=process.env[Ze]||e.remoteCacheUsage;return t!==W&&t!==Ee}function at(e){let t=process.env[Ze]||e.remoteCacheUsage;return t!==W&&t!==ye}var st=se(b("crypto")),mr=".yarn-scripts-cache",gr=2592e6,vr=1e3,ce=class{constructor(t,r){this.cwd=t,this.config=r}async saveCacheEntry(t){if(!rt(this.config))return;let r=this.buildCacheDir();await S.xfs.mkdirPromise(r,{recursive:!0});let n=this.buildCacheFile(r,t.key),i=JSON.stringify(t);await S.xfs.writeFilePromise(n,i),await this.cleanup()}async loadCacheEntry(t){if(!nt(this.config))return;let r=this.buildCacheDir();if(!await S.xfs.existsPromise(r))return;let n=this.buildCacheFile(r,t);if(await S.xfs.existsPromise(n)){let i=await S.xfs.readFilePromise(n,"utf8"),s=JSON.parse(i);if(yr(t,s.key))return s}}async cleanup(){let t=typeof this.config.localCacheMaxAge>"u"?gr:this.config.localCacheMaxAge,r=typeof this.config.localCacheMaxAmount>"u"?vr:this.config.localCacheMaxAmount,n=Date.now()-t,i=this.buildCacheDir(),a=(await S.xfs.readdirPromise(i)).map(c=>S.ppath.join(i,c)).map(Er);a.sort((c,u)=>u.creationDate-c.creationDate);let o=0;for(let c of a)c.creationDate<n?await S.xfs.unlinkPromise(c.file):o+=1,o>r&&await S.xfs.unlinkPromise(c.file)}buildCacheFile(t,r){let n=st.default.createHash("sha512");return n.update(JSON.stringify(r)),S.ppath.join(t,(0,S.toFilename)(`${n.digest("base64url")}.json`))}buildCacheDir(){return S.ppath.join(this.cwd,(0,S.toFilename)(mr))}};function yr(e,t){return JSON.stringify(e)===JSON.stringify(t)}function Er(e){let t=S.xfs.statSync(e);return{file:e,creationDate:t.mtime.getTime()}}var ue=class{constructor(t,r){this.url=t,this.config=r}async saveCacheEntry(t){it(this.config)}async loadCacheEntry(t){at(this.config)}};function ot(e,t){let r=[new ce(e,t)];return t.remoteCache&&r.push(new ue(new URL(t.remoteCache),t)),r}var zt=b("@yarnpkg/core"),k=b("@yarnpkg/fslib"),Zt=se(b("crypto"));var Qe=se(Re()),Yt=se(b("os"));async function er(e,t,r,n,i,s){let a=await rr(e,t,r,n,i);if(!a)return;let o=await En(r.cwd,n),c={key:a,value:o};for(let u of s)await u.saveCacheEntry(c)}async function tr(e,t,r,n,i,s){let a=await rr(e,t,r,n,i);if(!!a)for(let o of s){let c=await o.loadCacheEntry(a);if(c)return await bn(r.cwd,c.value),c}}async function rr(e,t,r,n,i){let s=r.script,a=r.args,o=e.lockFileChecksum,c=Ke(e.topLevelWorkspace.locator),u=Ke(t),h=await nr(r.cwd,n.inputIncludes,n.inputExcludes),d=await vn(e,t,i),l=gn(r,n);if(!!d)return{script:s,args:a,lockFileChecksum:o,topLevelWorkspaceLocator:c,workspaceLocator:u,globFileHashes:h,dependencyWorkspacesGlobFileHashes:d,environmentVariables:l}}function gn(e,t){let r={};for(let n of ie(t.environmentVariableIncludes)){let i={},s=new RegExp(n);for(let[a,o]of Object.entries(e.env))s.test(a)&&(i[a]=o);r[n]=i}return r}async function vn(e,t,r){let n={},i=e.getWorkspaceByLocator(t);for(let s of i.getRecursiveWorkspaceDependencies()){let a=Ke(s.locator),o=await oe(s.cwd,r);if(!o){r.reportError(zt.MessageName.UNNAMED,`Did not find a valid ${w} in workspace ${a}. All workspaces you depend on also need to be cachable!`);return}let c={};for(let u of o.scriptsToCache)c[u.scriptName]=await nr(s.cwd,u.outputIncludes,u.outputExcludes);n[a]=c}return n}async function nr(e,t,r){let n={};for(let i of ie(t)){let s=k.npath.fromPortablePath(e),a=Qe.glob.sync(i,{cwd:s,ignore:ie(r)}),o={};for(let c of a){let u=k.npath.toPortablePath(c),h=k.ppath.resolve(e,u);(await k.xfs.statPromise(h)).isFile()&&(o[u]=await yn(h))}n[i]=o}return n}async function yn(e){let t=Zt.default.createHash("sha512"),r=await k.xfs.readFilePromise(e,"base64");return t.update(r),t.digest("base64")}async function En(e,t){let r={};for(let s of ie(t.outputIncludes)){let a=k.npath.fromPortablePath(e),o=Qe.glob.sync(s,{cwd:a,ignore:ie(t.outputExcludes)}),c={};for(let u of o){let h=k.npath.toPortablePath(u),d=k.ppath.resolve(e,h);(await k.xfs.statPromise(d)).isFile()&&(c[h]=await k.xfs.readFilePromise(d,"base64"))}r[s]=c}let n=Date.now(),i=Yt.default.hostname();return{globFileContents:r,createdAt:n,createdBy:i}}async function bn(e,t){for(let r of Object.values(t.globFileContents))for(let[n,i]of Object.entries(r)){let s=k.ppath.join(e,n),a=k.ppath.dirname(s);await k.xfs.mkdirPromise(a,{recursive:!0}),await k.xfs.writeFilePromise(s,i,{encoding:"base64"})}}function Ke(e){return e.scope?`${e.scope}/${e.name}@${e.reference}`:`${e.name}@${e.reference}`}function ie(e){return e===void 0?[]:typeof e=="string"?[e]:e}async function wn(e){let t=z.Configuration.create(e.cwd);return z.StreamReport.start({configuration:t,includeFooter:!1,stdout:e.stdout},async()=>{})}var Cn=async(e,t,r,n,i)=>{let s=await wn(i),a=await oe(i.cwd,s);if(!a||Ye(a))return e;let o=a.scriptsToCache.find(u=>u.scriptName===n);if(!o)return e;let c=ot(i.cwd,a);return async()=>{if(tt(a)){let h=await tr(t,r,i,o,s,c);if(h){let d=new Date(h.value.createdAt).toUTCString(),l=h.value.createdBy;return s.reportInfo(z.MessageName.UNNAMED,`Script execution result was restored from cache! Created ${d} by ${l}`),Promise.resolve(0)}}let u=await e();return u===0&&et(a)&&await s.startTimerPromise("Updating script execution result cache",async()=>{await er(t,r,i,o,s,c)}),u}},An={hooks:{wrapScriptExecution:Cn}},_n=An;return hr(Sn);})();
return plugin;
}
};
