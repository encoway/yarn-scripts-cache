/* eslint-disable */
//prettier-ignore
module.exports = {
name: "@yarnpkg/plugin-scripts-cache",
factory: function (require) {
"use strict";var plugin=(()=>{var ir=Object.create;var st=Object.defineProperty;var sr=Object.getOwnPropertyDescriptor;var ar=Object.getOwnPropertyNames;var or=Object.getPrototypeOf,cr=Object.prototype.hasOwnProperty;var b=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')});var O=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),ur=(t,e)=>{for(var r in e)st(t,r,{get:e[r],enumerable:!0})},Jt=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of ar(e))!cr.call(t,i)&&i!==r&&st(t,i,{get:()=>e[i],enumerable:!(n=sr(e,i))||n.enumerable});return t};var zt=(t,e,r)=>(r=t!=null?ir(or(t)):{},Jt(e||!t||!t.__esModule?st(r,"default",{value:t,enumerable:!0}):r,t)),lr=t=>Jt(st({},"__esModule",{value:!0}),t);var ce=O(Et=>{var W=b("path"),R=process.platform==="win32",M=b("fs"),gr=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function mr(){var t;if(gr){var e=new Error;t=r}else t=n;return t;function r(i){i&&(e.message=i.message,i=e,n(i))}function n(i){if(i){if(process.throwDeprecation)throw i;if(!process.noDeprecation){var a="fs: missing callback "+(i.stack||i.message);process.traceDeprecation?console.trace(a):console.error(a)}}}}function vr(t){return typeof t=="function"?t:mr()}var Ln=W.normalize;R?F=/(.*?)(?:[\/\\]+|$)/g:F=/(.*?)(?:[\/]+|$)/g;var F;R?Y=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/:Y=/^[\/]*/;var Y;Et.realpathSync=function(e,r){if(e=W.resolve(e),r&&Object.prototype.hasOwnProperty.call(r,e))return r[e];var n=e,i={},a={},s,o,c,u;p();function p(){var m=Y.exec(e);s=m[0].length,o=m[0],c=m[0],u="",R&&!a[c]&&(M.lstatSync(c),a[c]=!0)}for(;s<e.length;){F.lastIndex=s;var d=F.exec(e);if(u=o,o+=d[0],c=u+d[1],s=F.lastIndex,!(a[c]||r&&r[c]===c)){var l;if(r&&Object.prototype.hasOwnProperty.call(r,c))l=r[c];else{var h=M.lstatSync(c);if(!h.isSymbolicLink()){a[c]=!0,r&&(r[c]=c);continue}var f=null;if(!R){var y=h.dev.toString(32)+":"+h.ino.toString(32);i.hasOwnProperty(y)&&(f=i[y])}f===null&&(M.statSync(c),f=M.readlinkSync(c)),l=W.resolve(u,f),r&&(r[c]=l),R||(i[y]=f)}e=W.resolve(l,e.slice(s)),p()}}return r&&(r[n]=e),e};Et.realpath=function(e,r,n){if(typeof n!="function"&&(n=vr(r),r=null),e=W.resolve(e),r&&Object.prototype.hasOwnProperty.call(r,e))return process.nextTick(n.bind(null,null,r[e]));var i=e,a={},s={},o,c,u,p;d();function d(){var m=Y.exec(e);o=m[0].length,c=m[0],u=m[0],p="",R&&!s[u]?M.lstat(u,function(_){if(_)return n(_);s[u]=!0,l()}):process.nextTick(l)}function l(){if(o>=e.length)return r&&(r[i]=e),n(null,e);F.lastIndex=o;var m=F.exec(e);return p=c,c+=m[0],u=p+m[1],o=F.lastIndex,s[u]||r&&r[u]===u?process.nextTick(l):r&&Object.prototype.hasOwnProperty.call(r,u)?y(r[u]):M.lstat(u,h)}function h(m,_){if(m)return n(m);if(!_.isSymbolicLink())return s[u]=!0,r&&(r[u]=u),process.nextTick(l);if(!R){var U=_.dev.toString(32)+":"+_.ino.toString(32);if(a.hasOwnProperty(U))return f(null,a[U],u)}M.stat(u,function(j){if(j)return n(j);M.readlink(u,function(E,g){R||(a[U]=g),f(E,g)})})}function f(m,_,U){if(m)return n(m);var j=W.resolve(p,_);r&&(r[U]=j),y(j)}function y(m){e=W.resolve(m,e.slice(o)),d()}}});var Ct=O((Mn,fe)=>{fe.exports=D;D.realpath=D;D.sync=_t;D.realpathSync=_t;D.monkeypatch=Er;D.unmonkeypatch=br;var J=b("fs"),bt=J.realpath,wt=J.realpathSync,yr=process.version,ue=/^v[0-5]\./.test(yr),le=ce();function he(t){return t&&t.syscall==="realpath"&&(t.code==="ELOOP"||t.code==="ENOMEM"||t.code==="ENAMETOOLONG")}function D(t,e,r){if(ue)return bt(t,e,r);typeof e=="function"&&(r=e,e=null),bt(t,e,function(n,i){he(n)?le.realpath(t,e,r):r(n,i)})}function _t(t,e){if(ue)return wt(t,e);try{return wt(t,e)}catch(r){if(he(r))return le.realpathSync(t,e);throw r}}function Er(){J.realpath=D,J.realpathSync=_t}function br(){J.realpath=bt,J.realpathSync=wt}});var de=O((Rn,pe)=>{var wr=typeof process=="object"&&process&&process.platform==="win32";pe.exports=wr?{sep:"\\"}:{sep:"/"}});var Ee=O((Dn,ye)=>{"use strict";ye.exports=me;function me(t,e,r){t instanceof RegExp&&(t=ge(t,r)),e instanceof RegExp&&(e=ge(e,r));var n=ve(t,e,r);return n&&{start:n[0],end:n[1],pre:r.slice(0,n[0]),body:r.slice(n[0]+t.length,n[1]),post:r.slice(n[1]+e.length)}}function ge(t,e){var r=e.match(t);return r?r[0]:null}me.range=ve;function ve(t,e,r){var n,i,a,s,o,c=r.indexOf(t),u=r.indexOf(e,c+1),p=c;if(c>=0&&u>0){if(t===e)return[c,u];for(n=[],a=r.length;p>=0&&!o;)p==c?(n.push(p),c=r.indexOf(t,p+1)):n.length==1?o=[n.pop(),u]:(i=n.pop(),i<a&&(a=i,s=u),u=r.indexOf(e,p+1)),p=c<u&&c>=0?c:u;n.length&&(o=[a,s])}return o}});var Ne=O(($n,ke)=>{var be=Ee();ke.exports=Sr;var we="\0SLASH"+Math.random()+"\0",_e="\0OPEN"+Math.random()+"\0",At="\0CLOSE"+Math.random()+"\0",Ce="\0COMMA"+Math.random()+"\0",Se="\0PERIOD"+Math.random()+"\0";function St(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}function _r(t){return t.split("\\\\").join(we).split("\\{").join(_e).split("\\}").join(At).split("\\,").join(Ce).split("\\.").join(Se)}function Cr(t){return t.split(we).join("\\").split(_e).join("{").split(At).join("}").split(Ce).join(",").split(Se).join(".")}function Ae(t){if(!t)return[""];var e=[],r=be("{","}",t);if(!r)return t.split(",");var n=r.pre,i=r.body,a=r.post,s=n.split(",");s[s.length-1]+="{"+i+"}";var o=Ae(a);return a.length&&(s[s.length-1]+=o.shift(),s.push.apply(s,o)),e.push.apply(e,s),e}function Sr(t){return t?(t.substr(0,2)==="{}"&&(t="\\{\\}"+t.substr(2)),tt(_r(t),!0).map(Cr)):[]}function Ar(t){return"{"+t+"}"}function kr(t){return/^-?0\d/.test(t)}function Nr(t,e){return t<=e}function Or(t,e){return t>=e}function tt(t,e){var r=[],n=be("{","}",t);if(!n)return[t];var i=n.pre,a=n.post.length?tt(n.post,!1):[""];if(/\$$/.test(n.pre))for(var s=0;s<a.length;s++){var o=i+"{"+n.body+"}"+a[s];r.push(o)}else{var c=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(n.body),u=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(n.body),p=c||u,d=n.body.indexOf(",")>=0;if(!p&&!d)return n.post.match(/,.*\}/)?(t=n.pre+"{"+n.body+At+n.post,tt(t)):[t];var l;if(p)l=n.body.split(/\.\./);else if(l=Ae(n.body),l.length===1&&(l=tt(l[0],!1).map(Ar),l.length===1))return a.map(function(dt){return n.pre+l[0]+dt});var h;if(p){var f=St(l[0]),y=St(l[1]),m=Math.max(l[0].length,l[1].length),_=l.length==3?Math.abs(St(l[2])):1,U=Nr,j=y<f;j&&(_*=-1,U=Or);var E=l.some(kr);h=[];for(var g=f;U(g,y);g+=_){var k;if(u)k=String.fromCharCode(g),k==="\\"&&(k="");else if(k=String(g),E){var T=m-k.length;if(T>0){var I=new Array(T+1).join("0");g<0?k="-"+I+k.slice(1):k=I+k}}h.push(k)}}else{h=[];for(var L=0;L<l.length;L++)h.push.apply(h,tt(l[L],!1))}for(var L=0;L<h.length;L++)for(var s=0;s<a.length;s++){var o=i+h[L]+a[s];(!e||p||o)&&r.push(o)}}return r}});var ht=O((Tn,Pt)=>{var P=Pt.exports=(t,e,r={})=>(lt(e),!r.nocomment&&e.charAt(0)==="#"?!1:new z(e,r).match(t));Pt.exports=P;var Nt=de();P.sep=Nt.sep;var x=Symbol("globstar **");P.GLOBSTAR=x;var Pr=Ne(),Oe={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},Ot="[^/]",kt=Ot+"*?",Ir="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",xr="(?:(?!(?:\\/|^)\\.).)*?",xe=t=>t.split("").reduce((e,r)=>(e[r]=!0,e),{}),Pe=xe("().*{}+?[]^$\\!"),Ur=xe("[.("),Ie=/\/+/;P.filter=(t,e={})=>(r,n,i)=>P(r,t,e);var $=(t,e={})=>{let r={};return Object.keys(t).forEach(n=>r[n]=t[n]),Object.keys(e).forEach(n=>r[n]=e[n]),r};P.defaults=t=>{if(!t||typeof t!="object"||!Object.keys(t).length)return P;let e=P,r=(n,i,a)=>e(n,i,$(t,a));return r.Minimatch=class extends e.Minimatch{constructor(i,a){super(i,$(t,a))}},r.Minimatch.defaults=n=>e.defaults($(t,n)).Minimatch,r.filter=(n,i)=>e.filter(n,$(t,i)),r.defaults=n=>e.defaults($(t,n)),r.makeRe=(n,i)=>e.makeRe(n,$(t,i)),r.braceExpand=(n,i)=>e.braceExpand(n,$(t,i)),r.match=(n,i,a)=>e.match(n,i,$(t,a)),r};P.braceExpand=(t,e)=>Ue(t,e);var Ue=(t,e={})=>(lt(t),e.nobrace||!/\{(?:(?!\{).)*\}/.test(t)?[t]:Pr(t)),jr=1024*64,lt=t=>{if(typeof t!="string")throw new TypeError("invalid pattern");if(t.length>jr)throw new TypeError("pattern is too long")},ut=Symbol("subparse");P.makeRe=(t,e)=>new z(t,e||{}).makeRe();P.match=(t,e,r={})=>{let n=new z(e,r);return t=t.filter(i=>n.match(i)),n.options.nonull&&!t.length&&t.push(e),t};var Lr=t=>t.replace(/\\(.)/g,"$1"),Fr=t=>t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),z=class{constructor(e,r){lt(e),r||(r={}),this.options=r,this.set=[],this.pattern=e,this.windowsPathsNoEscape=!!r.windowsPathsNoEscape||r.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!r.partial,this.make()}debug(){}make(){let e=this.pattern,r=this.options;if(!r.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate();let n=this.globSet=this.braceExpand();r.debug&&(this.debug=(...i)=>console.error(...i)),this.debug(this.pattern,n),n=this.globParts=n.map(i=>i.split(Ie)),this.debug(this.pattern,n),n=n.map((i,a,s)=>i.map(this.parse,this)),this.debug(this.pattern,n),n=n.filter(i=>i.indexOf(!1)===-1),this.debug(this.pattern,n),this.set=n}parseNegate(){if(this.options.nonegate)return;let e=this.pattern,r=!1,n=0;for(let i=0;i<e.length&&e.charAt(i)==="!";i++)r=!r,n++;n&&(this.pattern=e.substr(n)),this.negate=r}matchOne(e,r,n){var i=this.options;this.debug("matchOne",{this:this,file:e,pattern:r}),this.debug("matchOne",e.length,r.length);for(var a=0,s=0,o=e.length,c=r.length;a<o&&s<c;a++,s++){this.debug("matchOne loop");var u=r[s],p=e[a];if(this.debug(r,u,p),u===!1)return!1;if(u===x){this.debug("GLOBSTAR",[r,u,p]);var d=a,l=s+1;if(l===c){for(this.debug("** at the end");a<o;a++)if(e[a]==="."||e[a]===".."||!i.dot&&e[a].charAt(0)===".")return!1;return!0}for(;d<o;){var h=e[d];if(this.debug(`
globstar while`,e,d,r,l,h),this.matchOne(e.slice(d),r.slice(l),n))return this.debug("globstar found match!",d,o,h),!0;if(h==="."||h===".."||!i.dot&&h.charAt(0)==="."){this.debug("dot detected!",e,d,r,l);break}this.debug("globstar swallow a segment, and continue"),d++}return!!(n&&(this.debug(`
>>> no match, partial?`,e,d,r,l),d===o))}var f;if(typeof u=="string"?(f=p===u,this.debug("string match",u,p,f)):(f=p.match(u),this.debug("pattern match",u,p,f)),!f)return!1}if(a===o&&s===c)return!0;if(a===o)return n;if(s===c)return a===o-1&&e[a]==="";throw new Error("wtf?")}braceExpand(){return Ue(this.pattern,this.options)}parse(e,r){lt(e);let n=this.options;if(e==="**")if(n.noglobstar)e="*";else return x;if(e==="")return"";let i="",a=!!n.nocase,s=!1,o=[],c=[],u,p=!1,d=-1,l=-1,h,f,y,m=e.charAt(0)==="."?"":n.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",_=()=>{if(u){switch(u){case"*":i+=kt,a=!0;break;case"?":i+=Ot,a=!0;break;default:i+="\\"+u;break}this.debug("clearStateChar %j %j",u,i),u=!1}};for(let E=0,g;E<e.length&&(g=e.charAt(E));E++){if(this.debug("%s	%s %s %j",e,E,i,g),s){if(g==="/")return!1;Pe[g]&&(i+="\\"),i+=g,s=!1;continue}switch(g){case"/":return!1;case"\\":_(),s=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",e,E,i,g),p){this.debug("  in class"),g==="!"&&E===l+1&&(g="^"),i+=g;continue}this.debug("call clearStateChar %j",u),_(),u=g,n.noext&&_();continue;case"(":if(p){i+="(";continue}if(!u){i+="\\(";continue}o.push({type:u,start:E-1,reStart:i.length,open:Oe[u].open,close:Oe[u].close}),i+=u==="!"?"(?:(?!(?:":"(?:",this.debug("plType %j %j",u,i),u=!1;continue;case")":if(p||!o.length){i+="\\)";continue}_(),a=!0,f=o.pop(),i+=f.close,f.type==="!"&&c.push(f),f.reEnd=i.length;continue;case"|":if(p||!o.length){i+="\\|";continue}_(),i+="|";continue;case"[":if(_(),p){i+="\\"+g;continue}p=!0,l=E,d=i.length,i+=g;continue;case"]":if(E===l+1||!p){i+="\\"+g;continue}h=e.substring(l+1,E);try{RegExp("["+h+"]")}catch{y=this.parse(h,ut),i=i.substr(0,d)+"\\["+y[0]+"\\]",a=a||y[1],p=!1;continue}a=!0,p=!1,i+=g;continue;default:_(),Pe[g]&&!(g==="^"&&p)&&(i+="\\"),i+=g;break}}for(p&&(h=e.substr(l+1),y=this.parse(h,ut),i=i.substr(0,d)+"\\["+y[0],a=a||y[1]),f=o.pop();f;f=o.pop()){let E;E=i.slice(f.reStart+f.open.length),this.debug("setting tail",i,f),E=E.replace(/((?:\\{2}){0,64})(\\?)\|/g,(k,T,I)=>(I||(I="\\"),T+T+I+"|")),this.debug(`tail=%j
   %s`,E,E,f,i);let g=f.type==="*"?kt:f.type==="?"?Ot:"\\"+f.type;a=!0,i=i.slice(0,f.reStart)+g+"\\("+E}_(),s&&(i+="\\\\");let U=Ur[i.charAt(0)];for(let E=c.length-1;E>-1;E--){let g=c[E],k=i.slice(0,g.reStart),T=i.slice(g.reStart,g.reEnd-8),I=i.slice(g.reEnd),L=i.slice(g.reEnd-8,g.reEnd)+I,dt=k.split("(").length-1,gt=I;for(let Qt=0;Qt<dt;Qt++)gt=gt.replace(/\)[+*?]?/,"");I=gt;let nr=I===""&&r!==ut?"$":"";i=k+T+I+nr+L}if(i!==""&&a&&(i="(?=.)"+i),U&&(i=m+i),r===ut)return[i,a];if(!a)return Lr(e);let j=n.nocase?"i":"";try{return Object.assign(new RegExp("^"+i+"$",j),{_glob:e,_src:i})}catch{return new RegExp("$.")}}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;let e=this.set;if(!e.length)return this.regexp=!1,this.regexp;let r=this.options,n=r.noglobstar?kt:r.dot?Ir:xr,i=r.nocase?"i":"",a=e.map(s=>(s=s.map(o=>typeof o=="string"?Fr(o):o===x?x:o._src).reduce((o,c)=>(o[o.length-1]===x&&c===x||o.push(c),o),[]),s.forEach((o,c)=>{o!==x||s[c-1]===x||(c===0?s.length>1?s[c+1]="(?:\\/|"+n+"\\/)?"+s[c+1]:s[c]=n:c===s.length-1?s[c-1]+="(?:\\/|"+n+")?":(s[c-1]+="(?:\\/|\\/"+n+"\\/)"+s[c+1],s[c+1]=x))}),s.filter(o=>o!==x).join("/"))).join("|");a="^(?:"+a+")$",this.negate&&(a="^(?!"+a+").*$");try{this.regexp=new RegExp(a,i)}catch{this.regexp=!1}return this.regexp}match(e,r=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&r)return!0;let n=this.options;Nt.sep!=="/"&&(e=e.split(Nt.sep).join("/")),e=e.split(Ie),this.debug(this.pattern,"split",e);let i=this.set;this.debug(this.pattern,"set",i);let a;for(let s=e.length-1;s>=0&&(a=e[s],!a);s--);for(let s=0;s<i.length;s++){let o=i[s],c=e;if(n.matchBase&&o.length===1&&(c=[a]),this.matchOne(c,o,r))return n.flipNegate?!0:!this.negate}return n.flipNegate?!1:this.negate}static defaults(e){return P.defaults(e).Minimatch}};P.Minimatch=z});var je=O((Vn,It)=>{typeof Object.create=="function"?It.exports=function(e,r){r&&(e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:It.exports=function(e,r){if(r){e.super_=r;var n=function(){};n.prototype=r.prototype,e.prototype=new n,e.prototype.constructor=e}}});var Le=O((qn,Ut)=>{try{if(xt=b("util"),typeof xt.inherits!="function")throw"";Ut.exports=xt.inherits}catch{Ut.exports=je()}var xt});var Lt=O(G=>{G.setopts=Tr;G.ownProp=Fe;G.makeAbs=et;G.finish=Vr;G.mark=qr;G.isIgnored=Re;G.childrenIgnored=Wr;function Fe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var Mr=b("fs"),H=b("path"),Rr=ht(),Me=b("path").isAbsolute,jt=Rr.Minimatch;function Dr(t,e){return t.localeCompare(e,"en")}function $r(t,e){t.ignore=e.ignore||[],Array.isArray(t.ignore)||(t.ignore=[t.ignore]),t.ignore.length&&(t.ignore=t.ignore.map(Gr))}function Gr(t){var e=null;if(t.slice(-3)==="/**"){var r=t.replace(/(\/\*\*)+$/,"");e=new jt(r,{dot:!0})}return{matcher:new jt(t,{dot:!0}),gmatcher:e}}function Tr(t,e,r){if(r||(r={}),r.matchBase&&e.indexOf("/")===-1){if(r.noglobstar)throw new Error("base matching requires globstar");e="**/"+e}t.silent=!!r.silent,t.pattern=e,t.strict=r.strict!==!1,t.realpath=!!r.realpath,t.realpathCache=r.realpathCache||Object.create(null),t.follow=!!r.follow,t.dot=!!r.dot,t.mark=!!r.mark,t.nodir=!!r.nodir,t.nodir&&(t.mark=!0),t.sync=!!r.sync,t.nounique=!!r.nounique,t.nonull=!!r.nonull,t.nosort=!!r.nosort,t.nocase=!!r.nocase,t.stat=!!r.stat,t.noprocess=!!r.noprocess,t.absolute=!!r.absolute,t.fs=r.fs||Mr,t.maxLength=r.maxLength||1/0,t.cache=r.cache||Object.create(null),t.statCache=r.statCache||Object.create(null),t.symlinks=r.symlinks||Object.create(null),$r(t,r),t.changedCwd=!1;var n=process.cwd();Fe(r,"cwd")?(t.cwd=H.resolve(r.cwd),t.changedCwd=t.cwd!==n):t.cwd=H.resolve(n),t.root=r.root||H.resolve(t.cwd,"/"),t.root=H.resolve(t.root),t.cwdAbs=Me(t.cwd)?t.cwd:et(t,t.cwd),t.nomount=!!r.nomount,process.platform==="win32"&&(t.root=t.root.replace(/\\/g,"/"),t.cwd=t.cwd.replace(/\\/g,"/"),t.cwdAbs=t.cwdAbs.replace(/\\/g,"/")),r.nonegate=!0,r.nocomment=!0,r.allowWindowsEscape=!0,t.minimatch=new jt(e,r),t.options=t.minimatch.options}function Vr(t){for(var e=t.nounique,r=e?[]:Object.create(null),n=0,i=t.matches.length;n<i;n++){var a=t.matches[n];if(!a||Object.keys(a).length===0){if(t.nonull){var s=t.minimatch.globSet[n];e?r.push(s):r[s]=!0}}else{var o=Object.keys(a);e?r.push.apply(r,o):o.forEach(function(c){r[c]=!0})}}if(e||(r=Object.keys(r)),t.nosort||(r=r.sort(Dr)),t.mark){for(var n=0;n<r.length;n++)r[n]=t._mark(r[n]);t.nodir&&(r=r.filter(function(c){var u=!/\/$/.test(c),p=t.cache[c]||t.cache[et(t,c)];return u&&p&&(u=p!=="DIR"&&!Array.isArray(p)),u}))}t.ignore.length&&(r=r.filter(function(c){return!Re(t,c)})),t.found=r}function qr(t,e){var r=et(t,e),n=t.cache[r],i=e;if(n){var a=n==="DIR"||Array.isArray(n),s=e.slice(-1)==="/";if(a&&!s?i+="/":!a&&s&&(i=i.slice(0,-1)),i!==e){var o=et(t,i);t.statCache[o]=t.statCache[r],t.cache[o]=t.cache[r]}}return i}function et(t,e){var r=e;return e.charAt(0)==="/"?r=H.join(t.root,e):Me(e)||e===""?r=e:t.changedCwd?r=H.resolve(t.cwd,e):r=H.resolve(e),process.platform==="win32"&&(r=r.replace(/\\/g,"/")),r}function Re(t,e){return t.ignore.length?t.ignore.some(function(r){return r.matcher.match(e)||!!(r.gmatcher&&r.gmatcher.match(e))}):!1}function Wr(t,e){return t.ignore.length?t.ignore.some(function(r){return!!(r.gmatcher&&r.gmatcher.match(e))}):!1}});var Ve=O((Qn,Te)=>{Te.exports=Ge;Ge.GlobSync=S;var Hr=Ct(),De=ht(),Hn=De.Minimatch,Bn=Rt().Glob,Kn=b("util"),Ft=b("path"),$e=b("assert"),ft=b("path").isAbsolute,B=Lt(),Br=B.setopts,Mt=B.ownProp,Kr=B.childrenIgnored,Qr=B.isIgnored;function Ge(t,e){if(typeof e=="function"||arguments.length===3)throw new TypeError(`callback provided to sync glob
See: https://github.com/isaacs/node-glob/issues/167`);return new S(t,e).found}function S(t,e){if(!t)throw new Error("must provide pattern");if(typeof e=="function"||arguments.length===3)throw new TypeError(`callback provided to sync glob
See: https://github.com/isaacs/node-glob/issues/167`);if(!(this instanceof S))return new S(t,e);if(Br(this,t,e),this.noprocess)return this;var r=this.minimatch.set.length;this.matches=new Array(r);for(var n=0;n<r;n++)this._process(this.minimatch.set[n],n,!1);this._finish()}S.prototype._finish=function(){if($e.ok(this instanceof S),this.realpath){var t=this;this.matches.forEach(function(e,r){var n=t.matches[r]=Object.create(null);for(var i in e)try{i=t._makeAbs(i);var a=Hr.realpathSync(i,t.realpathCache);n[a]=!0}catch(s){if(s.syscall==="stat")n[t._makeAbs(i)]=!0;else throw s}})}B.finish(this)};S.prototype._process=function(t,e,r){$e.ok(this instanceof S);for(var n=0;typeof t[n]=="string";)n++;var i;switch(n){case t.length:this._processSimple(t.join("/"),e);return;case 0:i=null;break;default:i=t.slice(0,n).join("/");break}var a=t.slice(n),s;i===null?s=".":((ft(i)||ft(t.map(function(u){return typeof u=="string"?u:"[*]"}).join("/")))&&(!i||!ft(i))&&(i="/"+i),s=i);var o=this._makeAbs(s);if(!Kr(this,s)){var c=a[0]===De.GLOBSTAR;c?this._processGlobStar(i,s,o,a,e,r):this._processReaddir(i,s,o,a,e,r)}};S.prototype._processReaddir=function(t,e,r,n,i,a){var s=this._readdir(r,a);if(!!s){for(var o=n[0],c=!!this.minimatch.negate,u=o._glob,p=this.dot||u.charAt(0)===".",d=[],l=0;l<s.length;l++){var h=s[l];if(h.charAt(0)!=="."||p){var f;c&&!t?f=!h.match(o):f=h.match(o),f&&d.push(h)}}var y=d.length;if(y!==0){if(n.length===1&&!this.mark&&!this.stat){this.matches[i]||(this.matches[i]=Object.create(null));for(var l=0;l<y;l++){var h=d[l];t&&(t.slice(-1)!=="/"?h=t+"/"+h:h=t+h),h.charAt(0)==="/"&&!this.nomount&&(h=Ft.join(this.root,h)),this._emitMatch(i,h)}return}n.shift();for(var l=0;l<y;l++){var h=d[l],m;t?m=[t,h]:m=[h],this._process(m.concat(n),i,a)}}}};S.prototype._emitMatch=function(t,e){if(!Qr(this,e)){var r=this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=r),!this.matches[t][e]){if(this.nodir){var n=this.cache[r];if(n==="DIR"||Array.isArray(n))return}this.matches[t][e]=!0,this.stat&&this._stat(e)}}};S.prototype._readdirInGlobStar=function(t){if(this.follow)return this._readdir(t,!1);var e,r,n;try{r=this.fs.lstatSync(t)}catch(a){if(a.code==="ENOENT")return null}var i=r&&r.isSymbolicLink();return this.symlinks[t]=i,!i&&r&&!r.isDirectory()?this.cache[t]="FILE":e=this._readdir(t,!1),e};S.prototype._readdir=function(t,e){var r;if(e&&!Mt(this.symlinks,t))return this._readdirInGlobStar(t);if(Mt(this.cache,t)){var n=this.cache[t];if(!n||n==="FILE")return null;if(Array.isArray(n))return n}try{return this._readdirEntries(t,this.fs.readdirSync(t))}catch(i){return this._readdirError(t,i),null}};S.prototype._readdirEntries=function(t,e){if(!this.mark&&!this.stat)for(var r=0;r<e.length;r++){var n=e[r];t==="/"?n=t+n:n=t+"/"+n,this.cache[n]=!0}return this.cache[t]=e,e};S.prototype._readdirError=function(t,e){switch(e.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(t);if(this.cache[r]="FILE",r===this.cwdAbs){var n=new Error(e.code+" invalid cwd "+this.cwd);throw n.path=this.cwd,n.code=e.code,n}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:if(this.cache[this._makeAbs(t)]=!1,this.strict)throw e;this.silent||console.error("glob error",e);break}};S.prototype._processGlobStar=function(t,e,r,n,i,a){var s=this._readdir(r,a);if(!!s){var o=n.slice(1),c=t?[t]:[],u=c.concat(o);this._process(u,i,!1);var p=s.length,d=this.symlinks[r];if(!(d&&a))for(var l=0;l<p;l++){var h=s[l];if(!(h.charAt(0)==="."&&!this.dot)){var f=c.concat(s[l],o);this._process(f,i,!0);var y=c.concat(s[l],n);this._process(y,i,!0)}}}};S.prototype._processSimple=function(t,e){var r=this._stat(t);if(this.matches[e]||(this.matches[e]=Object.create(null)),!!r){if(t&&ft(t)&&!this.nomount){var n=/[\/\\]$/.test(t);t.charAt(0)==="/"?t=Ft.join(this.root,t):(t=Ft.resolve(this.root,t),n&&(t+="/"))}process.platform==="win32"&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t)}};S.prototype._stat=function(t){var e=this._makeAbs(t),r=t.slice(-1)==="/";if(t.length>this.maxLength)return!1;if(!this.stat&&Mt(this.cache,e)){var s=this.cache[e];if(Array.isArray(s)&&(s="DIR"),!r||s==="DIR")return s;if(r&&s==="FILE")return!1}var n,i=this.statCache[e];if(!i){var a;try{a=this.fs.lstatSync(e)}catch(o){if(o&&(o.code==="ENOENT"||o.code==="ENOTDIR"))return this.statCache[e]=!1,!1}if(a&&a.isSymbolicLink())try{i=this.fs.statSync(e)}catch{i=a}else i=a}this.statCache[e]=i;var s=!0;return i&&(s=i.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||s,r&&s==="FILE"?!1:s};S.prototype._mark=function(t){return B.mark(this,t)};S.prototype._makeAbs=function(t){return B.makeAbs(this,t)}});var Dt=O((Jn,We)=>{We.exports=qe;function qe(t,e){if(t&&e)return qe(t)(e);if(typeof t!="function")throw new TypeError("need wrapper function");return Object.keys(t).forEach(function(n){r[n]=t[n]}),r;function r(){for(var n=new Array(arguments.length),i=0;i<n.length;i++)n[i]=arguments[i];var a=t.apply(this,n),s=n[n.length-1];return typeof a=="function"&&a!==s&&Object.keys(s).forEach(function(o){a[o]=s[o]}),a}}});var Gt=O((zn,$t)=>{var He=Dt();$t.exports=He(pt);$t.exports.strict=He(Be);pt.proto=pt(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return pt(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return Be(this)},configurable:!0})});function pt(t){var e=function(){return e.called?e.value:(e.called=!0,e.value=t.apply(this,arguments))};return e.called=!1,e}function Be(t){var e=function(){if(e.called)throw new Error(e.onceError);return e.called=!0,e.value=t.apply(this,arguments)},r=t.name||"Function wrapped with `once`";return e.onceError=r+" shouldn't be called more than once",e.called=!1,e}});var Qe=O((Xn,Ke)=>{var Jr=Dt(),rt=Object.create(null),zr=Gt();Ke.exports=Jr(Xr);function Xr(t,e){return rt[t]?(rt[t].push(e),null):(rt[t]=[e],Zr(t))}function Zr(t){return zr(function e(){var r=rt[t],n=r.length,i=Yr(arguments);try{for(var a=0;a<n;a++)r[a].apply(null,i)}finally{r.length>n?(r.splice(0,n),process.nextTick(function(){e.apply(null,i)})):delete rt[t]}})}function Yr(t){for(var e=t.length,r=[],n=0;n<e;n++)r[n]=t[n];return r}});var Rt=O((ti,ze)=>{ze.exports=K;var tn=Ct(),Je=ht(),Zn=Je.Minimatch,en=Le(),rn=b("events").EventEmitter,Tt=b("path"),Vt=b("assert"),nt=b("path").isAbsolute,Wt=Ve(),Q=Lt(),nn=Q.setopts,qt=Q.ownProp,Ht=Qe(),Yn=b("util"),sn=Q.childrenIgnored,an=Q.isIgnored,on=Gt();function K(t,e,r){if(typeof e=="function"&&(r=e,e={}),e||(e={}),e.sync){if(r)throw new TypeError("callback provided to sync glob");return Wt(t,e)}return new v(t,e,r)}K.sync=Wt;var cn=K.GlobSync=Wt.GlobSync;K.glob=K;function un(t,e){if(e===null||typeof e!="object")return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t}K.hasMagic=function(t,e){var r=un({},e);r.noprocess=!0;var n=new v(t,r),i=n.minimatch.set;if(!t)return!1;if(i.length>1)return!0;for(var a=0;a<i[0].length;a++)if(typeof i[0][a]!="string")return!0;return!1};K.Glob=v;en(v,rn);function v(t,e,r){if(typeof e=="function"&&(r=e,e=null),e&&e.sync){if(r)throw new TypeError("callback provided to sync glob");return new cn(t,e)}if(!(this instanceof v))return new v(t,e,r);nn(this,t,e),this._didRealPath=!1;var n=this.minimatch.set.length;this.matches=new Array(n),typeof r=="function"&&(r=on(r),this.on("error",r),this.on("end",function(c){r(null,c)}));var i=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(n===0)return o();for(var a=!0,s=0;s<n;s++)this._process(this.minimatch.set[s],s,!1,o);a=!1;function o(){--i._processing,i._processing<=0&&(a?process.nextTick(function(){i._finish()}):i._finish())}}v.prototype._finish=function(){if(Vt(this instanceof v),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();Q.finish(this),this.emit("end",this.found)}};v.prototype._realpath=function(){if(this._didRealpath)return;this._didRealpath=!0;var t=this.matches.length;if(t===0)return this._finish();for(var e=this,r=0;r<this.matches.length;r++)this._realpathSet(r,n);function n(){--t===0&&e._finish()}};v.prototype._realpathSet=function(t,e){var r=this.matches[t];if(!r)return e();var n=Object.keys(r),i=this,a=n.length;if(a===0)return e();var s=this.matches[t]=Object.create(null);n.forEach(function(o,c){o=i._makeAbs(o),tn.realpath(o,i.realpathCache,function(u,p){u?u.syscall==="stat"?s[o]=!0:i.emit("error",u):s[p]=!0,--a===0&&(i.matches[t]=s,e())})})};v.prototype._mark=function(t){return Q.mark(this,t)};v.prototype._makeAbs=function(t){return Q.makeAbs(this,t)};v.prototype.abort=function(){this.aborted=!0,this.emit("abort")};v.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))};v.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var t=this._emitQueue.slice(0);this._emitQueue.length=0;for(var e=0;e<t.length;e++){var r=t[e];this._emitMatch(r[0],r[1])}}if(this._processQueue.length){var n=this._processQueue.slice(0);this._processQueue.length=0;for(var e=0;e<n.length;e++){var i=n[e];this._processing--,this._process(i[0],i[1],i[2],i[3])}}}};v.prototype._process=function(t,e,r,n){if(Vt(this instanceof v),Vt(typeof n=="function"),!this.aborted){if(this._processing++,this.paused){this._processQueue.push([t,e,r,n]);return}for(var i=0;typeof t[i]=="string";)i++;var a;switch(i){case t.length:this._processSimple(t.join("/"),e,n);return;case 0:a=null;break;default:a=t.slice(0,i).join("/");break}var s=t.slice(i),o;a===null?o=".":((nt(a)||nt(t.map(function(p){return typeof p=="string"?p:"[*]"}).join("/")))&&(!a||!nt(a))&&(a="/"+a),o=a);var c=this._makeAbs(o);if(sn(this,o))return n();var u=s[0]===Je.GLOBSTAR;u?this._processGlobStar(a,o,c,s,e,r,n):this._processReaddir(a,o,c,s,e,r,n)}};v.prototype._processReaddir=function(t,e,r,n,i,a,s){var o=this;this._readdir(r,a,function(c,u){return o._processReaddir2(t,e,r,n,i,a,u,s)})};v.prototype._processReaddir2=function(t,e,r,n,i,a,s,o){if(!s)return o();for(var c=n[0],u=!!this.minimatch.negate,p=c._glob,d=this.dot||p.charAt(0)===".",l=[],h=0;h<s.length;h++){var f=s[h];if(f.charAt(0)!=="."||d){var y;u&&!t?y=!f.match(c):y=f.match(c),y&&l.push(f)}}var m=l.length;if(m===0)return o();if(n.length===1&&!this.mark&&!this.stat){this.matches[i]||(this.matches[i]=Object.create(null));for(var h=0;h<m;h++){var f=l[h];t&&(t!=="/"?f=t+"/"+f:f=t+f),f.charAt(0)==="/"&&!this.nomount&&(f=Tt.join(this.root,f)),this._emitMatch(i,f)}return o()}n.shift();for(var h=0;h<m;h++){var f=l[h],_;t&&(t!=="/"?f=t+"/"+f:f=t+f),this._process([f].concat(n),i,a,o)}o()};v.prototype._emitMatch=function(t,e){if(!this.aborted&&!an(this,e)){if(this.paused){this._emitQueue.push([t,e]);return}var r=nt(e)?e:this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=r),!this.matches[t][e]){if(this.nodir){var n=this.cache[r];if(n==="DIR"||Array.isArray(n))return}this.matches[t][e]=!0;var i=this.statCache[r];i&&this.emit("stat",e,i),this.emit("match",e)}}};v.prototype._readdirInGlobStar=function(t,e){if(this.aborted)return;if(this.follow)return this._readdir(t,!1,e);var r="lstat\0"+t,n=this,i=Ht(r,a);i&&n.fs.lstat(t,i);function a(s,o){if(s&&s.code==="ENOENT")return e();var c=o&&o.isSymbolicLink();n.symlinks[t]=c,!c&&o&&!o.isDirectory()?(n.cache[t]="FILE",e()):n._readdir(t,!1,e)}};v.prototype._readdir=function(t,e,r){if(!this.aborted&&(r=Ht("readdir\0"+t+"\0"+e,r),!!r)){if(e&&!qt(this.symlinks,t))return this._readdirInGlobStar(t,r);if(qt(this.cache,t)){var n=this.cache[t];if(!n||n==="FILE")return r();if(Array.isArray(n))return r(null,n)}var i=this;i.fs.readdir(t,ln(this,t,r))}};function ln(t,e,r){return function(n,i){n?t._readdirError(e,n,r):t._readdirEntries(e,i,r)}}v.prototype._readdirEntries=function(t,e,r){if(!this.aborted){if(!this.mark&&!this.stat)for(var n=0;n<e.length;n++){var i=e[n];t==="/"?i=t+i:i=t+"/"+i,this.cache[i]=!0}return this.cache[t]=e,r(null,e)}};v.prototype._readdirError=function(t,e,r){if(!this.aborted){switch(e.code){case"ENOTSUP":case"ENOTDIR":var n=this._makeAbs(t);if(this.cache[n]="FILE",n===this.cwdAbs){var i=new Error(e.code+" invalid cwd "+this.cwd);i.path=this.cwd,i.code=e.code,this.emit("error",i),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:this.cache[this._makeAbs(t)]=!1,this.strict&&(this.emit("error",e),this.abort()),this.silent||console.error("glob error",e);break}return r()}};v.prototype._processGlobStar=function(t,e,r,n,i,a,s){var o=this;this._readdir(r,a,function(c,u){o._processGlobStar2(t,e,r,n,i,a,u,s)})};v.prototype._processGlobStar2=function(t,e,r,n,i,a,s,o){if(!s)return o();var c=n.slice(1),u=t?[t]:[],p=u.concat(c);this._process(p,i,!1,o);var d=this.symlinks[r],l=s.length;if(d&&a)return o();for(var h=0;h<l;h++){var f=s[h];if(!(f.charAt(0)==="."&&!this.dot)){var y=u.concat(s[h],c);this._process(y,i,!0,o);var m=u.concat(s[h],n);this._process(m,i,!0,o)}}o()};v.prototype._processSimple=function(t,e,r){var n=this;this._stat(t,function(i,a){n._processSimple2(t,e,i,a,r)})};v.prototype._processSimple2=function(t,e,r,n,i){if(this.matches[e]||(this.matches[e]=Object.create(null)),!n)return i();if(t&&nt(t)&&!this.nomount){var a=/[\/\\]$/.test(t);t.charAt(0)==="/"?t=Tt.join(this.root,t):(t=Tt.resolve(this.root,t),a&&(t+="/"))}process.platform==="win32"&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t),i()};v.prototype._stat=function(t,e){var r=this._makeAbs(t),n=t.slice(-1)==="/";if(t.length>this.maxLength)return e();if(!this.stat&&qt(this.cache,r)){var i=this.cache[r];if(Array.isArray(i)&&(i="DIR"),!n||i==="DIR")return e(null,i);if(n&&i==="FILE")return e()}var a,s=this.statCache[r];if(s!==void 0){if(s===!1)return e(null,s);var o=s.isDirectory()?"DIR":"FILE";return n&&o==="FILE"?e():e(null,o,s)}var c=this,u=Ht("stat\0"+r,p);u&&c.fs.lstat(r,u);function p(d,l){if(l&&l.isSymbolicLink())return c.fs.stat(r,function(h,f){h?c._stat2(t,r,null,l,e):c._stat2(t,r,h,f,e)});c._stat2(t,r,d,l,e)}};v.prototype._stat2=function(t,e,r,n,i){if(r&&(r.code==="ENOENT"||r.code==="ENOTDIR"))return this.statCache[e]=!1,i();var a=t.slice(-1)==="/";if(this.statCache[e]=n,e.slice(-1)==="/"&&n&&!n.isDirectory())return i(null,!1,n);var s=!0;return n&&(s=n.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||s,a&&s==="FILE"?i():i(null,s,n)}});var bn={};ur(bn,{default:()=>En});var X=b("@yarnpkg/core");var C=b("@yarnpkg/core"),V=b("@yarnpkg/fslib"),w=".yarn-scripts-cache-rc.json";function hr(t,e){if(typeof t!="object")return e.reportError(C.MessageName.UNNAMED,`${w} is not valid: config is not an object!`),!1;if(!Array.isArray(t.scriptsToCache))return e.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.scriptsToCache is not an array!`),!1;if(t.scriptsToCache.find(r=>typeof r!="object")!==void 0)return e.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.scriptsToCache should only contain objects!`),!1;if(t.scriptsToCache.find(r=>!pr(r,e))!==void 0)return!1;if(t.remoteCache){if(typeof t.remoteCache!="string")return e.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.remoteCache should be a string!`),!1;if(!fr(t.remoteCache))return e.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.remoteCache should be a valid URLs!`),!1}return t.cacheUsage&&!mt(t.cacheUsage)?(e.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.cacheUsage is not a valid value!`),!1):t.localCacheUsage&&!mt(t.localCacheUsage)?(e.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.localCacheUsage is not a valid value!`),!1):t.remoteCacheUsage&&!mt(t.remoteCacheUsage)?(e.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.remoteCacheUsage is not a valid value!`),!1):!0}function mt(t){return t==="enabled"||t==="disabled"||t==="update-cache-only"||t==="update-script-execution-result-only"}function fr(t){try{return new URL(t),!0}catch{return!1}}function pr(t,e){if(typeof t.scriptName!="string")return e.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.scriptsToCache.scriptName is no string!`),!1;if(t.inputIncludes!==void 0&&typeof t.inputIncludes!="string"){if(!Array.isArray(t.inputIncludes))return e.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.scriptsToCache.inputIncludes for ${t.scriptName} is not an array!`),!1;if(t.inputIncludes.find(r=>typeof r!="string")!==void 0)return e.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.scriptsToCache.inputIncludes for ${t.scriptName} should only contain strings!`),!1}if(t.inputExcludes!==void 0&&typeof t.inputExcludes!="string"){if(!Array.isArray(t.inputExcludes))return e.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.scriptsToCache.inputExcludes for ${t.scriptName} is not an array!`),!1;if(t.inputExcludes.find(r=>typeof r!="string")!==void 0)return e.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.scriptsToCache.inputExcludes for ${t.scriptName} should only contain strings!`),!1}if(t.outputIncludes!==void 0&&typeof t.outputIncludes!="string"){if(!Array.isArray(t.outputIncludes))return e.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.scriptsToCache.outputIncludes for ${t.scriptName} is not an array!`),!1;if(t.outputIncludes.find(r=>typeof r!="string")!==void 0)return e.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.scriptsToCache.outputIncludes for ${t.scriptName} should only contain strings!`),!1}if(t.outputExcludes!==void 0&&typeof t.outputExcludes!="string"){if(!Array.isArray(t.outputExcludes))return e.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.scriptsToCache.outputExcludes for ${t.scriptName} is not an array!`),!1;if(t.outputExcludes.find(r=>typeof r!="string")!==void 0)return e.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.scriptsToCache.outputExcludes for ${t.scriptName} should only contain strings!`),!1}if(t.environmentVariableIncludes!==void 0&&typeof t.environmentVariableIncludes!="string"){if(!Array.isArray(t.environmentVariableIncludes))return e.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.scriptsToCache.environmentVariableIncludes for ${t.scriptName} is not an array!`),!1;if(t.environmentVariableIncludes.find(r=>typeof r!="string")!==void 0)return e.reportError(C.MessageName.UNNAMED,`${w} is not valid: config.scriptsToCache.environmentVariableIncludes for ${t.scriptName} should only contain strings!`),!1}return!0}async function at(t,e){let r=V.ppath.join(t,(0,V.toFilename)(w));if(await V.xfs.existsPromise(r)){let n=await V.xfs.readFilePromise(r,"utf-8");try{let i=JSON.parse(n);if(hr(i,e))return i}catch(i){e.reportErrorOnce(C.MessageName.EXCEPTION,`${w} is not valid:`),e.reportExceptionOnce(i)}}}var N=b("@yarnpkg/fslib");var Z="SCRIPT_RESULTS_CACHE",Xt=Z+"_LOCAL",Zt=Z+"_REMOTE",q="disabled",vt="update-cache-only",yt="update-script-execution-result-only";function Yt(t){return(process.env[Z]||t.cacheUsage)===q}function te(t){let e=process.env[Z]||t.cacheUsage;return e!==q&&e!==yt}function ee(t){let e=process.env[Z]||t.cacheUsage;return e!==q&&e!==vt}function re(t){let e=process.env[Xt]||t.localCacheUsage;return e!==q&&e!==yt}function ne(t){let e=process.env[Xt]||t.localCacheUsage;return e!==q&&e!==vt}function ie(t){let e=process.env[Zt]||t.remoteCacheUsage;return e!==q&&e!==yt}function se(t){let e=process.env[Zt]||t.remoteCacheUsage;return e!==q&&e!==vt}var ae=".yarn-scripts-cache",ot=class{constructor(e,r){this.cwd=e,this.config=r}async saveCacheEntry(e){if(!re(this.config))return;let r=Date.now().toString()+".json",n=JSON.stringify(e),i=N.ppath.join(this.cwd,(0,N.toFilename)(ae));await N.xfs.mkdirPromise(i,{recursive:!0});let a=N.ppath.join(i,(0,N.toFilename)(r));await N.xfs.writeFilePromise(a,n)}async loadCacheEntry(e){if(!ne(this.config))return;let r=N.ppath.join(this.cwd,(0,N.toFilename)(ae));if(!await N.xfs.existsPromise(r))return;let n=await N.xfs.readdirPromise(r);for(let i of n){let a=N.ppath.join(r,i),s=await N.xfs.readFilePromise(a,"utf8"),o=JSON.parse(s);if(dr(e,o.key))return o}}};function dr(t,e){return JSON.stringify(t)===JSON.stringify(e)}var ct=class{constructor(e,r){this.url=e,this.config=r}async saveCacheEntry(e){ie(this.config)}async loadCacheEntry(e){se(this.config)}};function oe(t,e){let r=[new ot(t,e)];return e.remoteCache&&r.push(new ct(new URL(e.remoteCache),e)),r}var Xe=b("@yarnpkg/core"),A=b("@yarnpkg/fslib"),Ze=zt(b("crypto"));var Kt=zt(Rt());async function Ye(t,e,r,n,i,a){let s=await er(t,e,r,n,i);if(!s)return;let o=await dn(r.cwd,n),c={key:s,value:o};for(let u of a)await u.saveCacheEntry(c)}async function tr(t,e,r,n,i,a){let s=await er(t,e,r,n,i);if(!s)return!1;for(let o of a){let c=await o.loadCacheEntry(s);if(c)return await gn(r.cwd,c.value),!0}return!1}async function er(t,e,r,n,i){let a=r.script,s=r.args,o=t.lockFileChecksum,c=Bt(t.topLevelWorkspace.locator),u=Bt(e),p=await rr(r.cwd,n.inputIncludes,n.inputExcludes),d=await fn(t,e,i),l=hn(r,n);if(!!d)return{script:a,args:s,lockFileChecksum:o,topLevelWorkspaceLocator:c,workspaceLocator:u,globFileHashes:p,dependencyWorkspacesGlobFileHashes:d,environmentVariables:l}}function hn(t,e){let r={};for(let n of it(e.environmentVariableIncludes)){let i={},a=new RegExp(n);for(let[s,o]of Object.entries(t.env))a.test(s)&&(i[s]=o);r[n]=i}return r}async function fn(t,e,r){let n={},i=t.getWorkspaceByLocator(e);for(let a of i.getRecursiveWorkspaceDependencies()){let s=Bt(a.locator),o=await at(a.cwd,r);if(!o){r.reportError(Xe.MessageName.UNNAMED,`Did not find a valid ${w} in workspace ${s}. All workspaces you depend on also need to be cachable!`);return}let c={};for(let u of o.scriptsToCache)c[u.scriptName]=await rr(a.cwd,u.outputIncludes,u.outputExcludes);n[s]=c}return n}async function rr(t,e,r){let n={};for(let i of it(e)){let a=A.npath.fromPortablePath(t),s=Kt.glob.sync(i,{cwd:a,ignore:it(r)}),o={};for(let c of s){let u=A.npath.toPortablePath(c),p=A.ppath.resolve(t,u);(await A.xfs.statPromise(p)).isFile()&&(o[u]=await pn(p))}n[i]=o}return n}async function pn(t){let e=Ze.default.createHash("sha512"),r=await A.xfs.readFilePromise(t,"base64");return e.update(r),e.digest("base64")}async function dn(t,e){let r={};for(let n of it(e.outputIncludes)){let i=A.npath.fromPortablePath(t),a=Kt.glob.sync(n,{cwd:i,ignore:it(e.outputExcludes)}),s={};for(let o of a){let c=A.npath.toPortablePath(o),u=A.ppath.resolve(t,c);(await A.xfs.statPromise(u)).isFile()&&(s[c]=await A.xfs.readFilePromise(u,"base64"))}r[n]=s}return{globFileContents:r}}async function gn(t,e){for(let r of Object.values(e.globFileContents))for(let[n,i]of Object.entries(r)){let a=A.ppath.join(t,n),s=A.ppath.dirname(a);await A.xfs.mkdirPromise(s,{recursive:!0}),await A.xfs.writeFilePromise(a,i,{encoding:"base64"})}}function Bt(t){return t.scope?`${t.scope}/${t.name}@${t.reference}`:`${t.name}@${t.reference}`}function it(t){return t===void 0?[]:typeof t=="string"?[t]:t}async function mn(t){let e=X.Configuration.create(t.cwd);return X.StreamReport.start({configuration:e,includeFooter:!1,stdout:t.stdout},async()=>{})}var vn=async(t,e,r,n,i)=>{let a=await mn(i),s=await at(i.cwd,a);if(!s||Yt(s))return t;let o=s.scriptsToCache.find(u=>u.scriptName===n);if(!o)return t;let c=oe(i.cwd,s);return async()=>{if(ee(s)&&await tr(e,r,i,o,a,c))return a.reportInfo(X.MessageName.UNNAMED,"Script execution result was restored from cache!"),Promise.resolve(0);{let u=await t();return u===0&&te(s)&&await a.startTimerPromise("Updating script execution result cache",async()=>{await Ye(e,r,i,o,a,c)}),u}}},yn={hooks:{wrapScriptExecution:vn}},En=yn;return lr(bn);})();
return plugin;
}
};
